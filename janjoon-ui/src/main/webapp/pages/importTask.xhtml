<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:p="http://primefaces.org/ui">

<ui:composition>
	<style type="text/css">
.ui-datatable-header {
	text-align: center !important;
	position: relative;
	height: 25px;
}
</style>
	<h:form id="importTaskDialogForm">

		<pe:blockUI widgetVar="taskBlockUIWidget"
			target="importTaskDialogForm">
			<h:panelGrid columns="2" layout="grid">
				<p:graphicImage library="images" name="ajax-loader.gif"
					style="vertical-align: middle;" />
				<h:outputText value="#{messages.label_refresh}"
					style="white-space: nowrap;" />
			</h:panelGrid>
		</pe:blockUI>
		<p:panelGrid style="margin-top:10px">
			<p:row>
				<p:column>
					<h:outputText value="Objet:" />
					<p:selectOneMenu id="objetSelectOneMenu"
						value="#{jJTaskBean.objet}" panelStyle="width:150px" effect="fade"
						style="width:160px" filter="true" filterMatchMode="startsWith">
						<f:selectItem itemValue="#{null}"
							itemLabel="#{messages.importTask_selectObject}" />
						<f:selectItems value="#{jJTaskBean.objets}" var="p"
							itemLabel="#{p}" itemValue="#{p}" />
						<p:ajax process="@this" partialSubmit="true"
							listener="#{jJTaskBean.handleSelectObjet}"
							update="importTaskDialogForm" />
					</p:selectOneMenu>
				</p:column>

				<p:column>
					<h:outputText
						value="#{messages.specification_import_category_label}" />
					<p:selectOneMenu id="categorySelectOneMenu"
						value="#{jJTaskBean.importCategory}" panelStyle="width:150px"
						effect="fade" style="width:160px" filter="true"
						filterMatchMode="startsWith"
						converter="com.starit.janjoonweb.ui.mb.converter.JJCategoryConverter"
						disabled="#{jJTaskBean.disabledFilter}">

						<f:selectItem itemValue="#{null}"
							itemLabel="#{messages.importTask_selectCategory}" />

						<f:selectItems value="#{jJTaskBean.importCategoryList}" var="p"
							itemLabel="#{p.name}" itemValue="#{p}" />
						<p:ajax process="@this" partialSubmit="true"
							listener="#{jJTaskBean.handleSelectCategory}"
							update="importTaskDialogForm" />
					</p:selectOneMenu>
				</p:column>

				<p:column>
					<h:outputText value="#{messages.specification_import_status_label}" />
					<p:selectOneMenu id="statusSelectOneMenu"
						value="#{jJTaskBean.importStatus}" panelStyle="width:150px"
						effect="fade" style="width:160px" filter="true"
						filterMatchMode="startsWith"
						converter="com.starit.janjoonweb.ui.mb.converter.JJStatusConverter"
						disabled="#{jJTaskBean.disabledFilter}">

						<f:selectItem itemValue="#{null}"
							itemLabel="#{messages.importTask_selectStatus}" />
						<f:selectItems value="#{jJTaskBean.importStatusList}" var="p"
							itemLabel="#{p.name}" itemValue="#{p}" />
						<p:ajax process="@this" partialSubmit="true"
							listener="#{jJTaskBean.handleSelectStatus}"
							update="importTaskDialogForm" />
					</p:selectOneMenu>
				</p:column>

				<p:column>
					<h:outputText value="#{messages.importTask_viewAll}: " />

					<p:selectBooleanCheckbox value="#{jJTaskBean.checkAll}">
						<p:ajax update="importTaskDialogForm"
							listener="#{jJTaskBean.checkAll}" />
					</p:selectBooleanCheckbox>
				</p:column>

			</p:row>
		</p:panelGrid>

		<p:dataTable id="importDataTable" var="format" scrollable="true"
			style="width:700px;table-layout: fixed;" scrollHeight="350" emptyMessage="#{messages.label_notRecordFound}"
			value="#{jJTaskBean.importFormats}" editable="true" editMode="cell">
			<f:facet name="header">
				<p:row>
					<p:column style="width: 40%">
						<p:commandButton id="importDate" value="Remplir Les Dates"
							onstart="PF('taskBlockUIWidget').block()"
							disabled="#{jJTaskBean.fillInDate}"
							style="position: absolute;left: 10px;"
							oncomplete="PF('taskBlockUIWidget').unblock()"
							actionListener="#{jJTaskBean.fillInDates}"
							update="importDataTable" />
					</p:column>
					<p:column style="width: 20%"></p:column>
					<p:column style="width: 40%">
						<h:outputText value="Import #{jJTaskBean.objet}"
							style="position: absolute;right: 10px;" />
					</p:column>
				</p:row>
			</f:facet>
			<p:column style="width:40%" id="checkBox">
				<f:facet name="header">
					<p:row>
						<p:column>
							<p:selectBooleanCheckbox value="#{jJTaskBean.copyObjets}"
								id="checkAll">
								<p:ajax update="importDataTable" process="@this,checkAll"
									listener="#{jJTaskBean.copyObjetsListener}" />
							</p:selectBooleanCheckbox>
						</p:column>
						<p:column>
							<h:outputText value="#{messages.importTask_headerTable_tasks}" />
						</p:column>
					</p:row>
				</f:facet>
				<p:selectBooleanCheckbox value="#{format.copyObjet}" id="checkOne">
					<p:ajax update="importDataTable" listener="#{jJTaskBean.copyObjetListener}"
						process="@this,checkAll" />
				</p:selectBooleanCheckbox>
				<h:outputText value="#{format.name}" id="reqContent" />
				<p:tooltip id="toolTipContent" for="reqContent" showEffect="fade"
					hideEffect="fade" style="width:300px"
					rendered="#{jJTaskBean.objet == 'Requirement'}">
					<p:panelGrid style="width:300px">
						<f:facet name="header">
							<p:row>
								<p:column>
									<h:outputText style="font-weight: bold;"
										value="Requirement: #{format.object.name}" />
								</p:column>
							</p:row>
						</f:facet>
						<p:row>
							<p:column>
								<p:outputLabel style="font-weight: bold;" for="tolDesc"
									value="Description :" />
								<br />
								<h:outputText id="tolDesc" readonly="true" escape="false"
									style="width:300px" value="#{format.object.description}" />
							</p:column>
						</p:row>
					</p:panelGrid>
				</p:tooltip>
			</p:column>

			<p:column style="width:30%" headerText="#{messages.importTask_headerTable_startDate}">
				<p:cellEditor>
					<f:facet name="output">
						<p:calendar value="#{format.startDate}" navigator="true"
							pattern="yyyy/MM/dd HH:mm" />
					</f:facet>
					<f:facet name="input">
						<p:calendar value="#{format.startDate}" navigator="true"
							pattern="yyyy/MM/dd HH:mm">
						</p:calendar>

					</f:facet>
				</p:cellEditor>
			</p:column>

			<p:column style="width:15%" headerText="#{messages.importTask_headerTable_requirement}">
				<p:panel style="height: 25px;width: 30px; margin: auto;">
					<p:commandButton id="specButton"
						value="#{format.specification ? 'X' : ' '}"
						styleClass="checkBoxButton" update="specButton"
						actionListener="#{format.setSpecification(!format.specification)}" />
				</p:panel>
			</p:column>
			<p:column style="width:15%" headerText="#{messages.importTask_headerTable_workload}">
				<p:cellEditor>
					<f:facet name="output">
						<h:outputText value="#{format.workload}" />

					</f:facet>
					<f:facet name="input">
						<p:spinner value="#{format.workload}" stepFactor="1" min="0">
						</p:spinner>

					</f:facet>
				</p:cellEditor>
			</p:column>

		</p:dataTable>

		<p:remoteCommand actionListener="#{jJTaskBean.importTask}"
			name="importTask" update=":projecttabview :growlForm"
			onstart="PF('taskBlockUIWidget').block()"
			oncomplete="PF('taskBlockUIWidget').unblock()" />

		<p:commandButton id="importButtonSC" value="Import"
			onstart="PF('taskBlockUIWidget').block()"
			oncomplete="PF('taskBlockUIWidget').unblock()" style="float: right;"
			actionListener="#{jJTaskBean.validateTaskField}" update=":growlForm" />
		<p:commandButton value="Annuler" style="float: right;"
			oncomplete="PF('taskImportDialogWidget').hide()" />
	</h:form>
</ui:composition>
</html>
