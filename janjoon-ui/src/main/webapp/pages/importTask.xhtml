<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:p="http://primefaces.org/ui">

<ui:composition>
	<style type="text/css">
.ui-datatable-header {
	text-align: center !important;
	position: relative;
	height: 25px;
}
</style>
	<h:form id="importTaskDialogForm">
		<p:remoteCommand actionListener="#{jJTaskBean.importTask}"
			name="importTask" update=":projecttabview :growlForm"
			onstart="PF('taskBlockUIWidget').block()"
			oncomplete="PF('taskBlockUIWidget').unblock()" />

		<pe:blockUI widgetVar="taskBlockUIWidget"
			target="importTaskDialogForm">
			<h:panelGrid columns="2" layout="grid">
				<p:graphicImage name="images/preloader.gif" library="rioLayout"
					style="vertical-align: middle;" />
				<h:outputText value="#{messages.label_refresh}"
					style="white-space: nowrap;" />
			</h:panelGrid>
		</pe:blockUI>
		<h:panelGroup layout="block" styleClass="Container ui-fluid BorderAll"
			style="max-width: 800px;">
			<h:panelGroup layout="block" styleClass="Container100">
				<p:messages id="msg" showDetail="false" closable="true" />
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="Container50 Responsive50">
				<h:panelGroup layout="block" style="/*margin-top: 5%;*/"
					styleClass="Container30">
					<h:panelGroup layout="block" styleClass="ContainerIndentLabel">
						<p:outputLabel for="objetSelectOneMenu" value="Objet:" />
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup layout="block" style="/*margin-top: 5%;*/"
					styleClass="Container70">
					<h:panelGroup layout="block" styleClass="ContainerIndent">
						<p:selectOneMenu id="objetSelectOneMenu"
							value="#{jJTaskBean.objet}" effect="fade">
							<f:selectItem itemValue="#{null}"
								itemLabel="#{messages.importTask_selectObject}" />
							<f:selectItems value="#{jJTaskBean.objets}" var="p"
								itemLabel="#{messages['importTask_selectObject_'.concat(p)]}"
								itemValue="#{p}" />
							<p:ajax process="@this" partialSubmit="true"
								listener="#{jJTaskBean.handleSelectObjet}"
								onstart="PF('taskBlockUIWidget').block()"
								oncomplete="PF('taskBlockUIWidget').unblock()"
								update="importTaskDialogForm" />
						</p:selectOneMenu>
					</h:panelGroup>
				</h:panelGroup>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="Container50 Responsive50">
				<h:panelGroup layout="block" style="/*margin-top: 5%;*/"
					styleClass="Container30">
					<h:panelGroup layout="block" styleClass="ContainerIndentLabel">
						<p:outputLabel for="categorySelectOneMenu"
							value="#{messages.specification_import_category_label}" />
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup layout="block" style="/*margin-top: 5%;*/"
					styleClass="Container70">
					<h:panelGroup layout="block" styleClass="ContainerIndent">
						<p:selectOneMenu id="categorySelectOneMenu"
							value="#{jJTaskBean.importCategory}" effect="fade"
							filter="#{!loginBean.mobile}" filterMatchMode="contains"
							converter="com.starit.janjoonweb.ui.mb.converter.JJCategoryConverter"
							disabled="#{jJTaskBean.disabledFilter}">

							<f:selectItem itemValue="#{null}"
								itemLabel="#{messages.importTask_selectCategory}" />

							<f:selectItems value="#{jJTaskBean.importCategoryList}" var="p"
								itemLabel="#{loginBean.checkMessage(p)}" itemValue="#{p}" />
							<p:ajax process="@this" partialSubmit="true"
								listener="#{jJTaskBean.handleSelectCategory}"
								onstart="PF('taskBlockUIWidget').block()"
								oncomplete="PF('taskBlockUIWidget').unblock()"
								update="importTaskDialogForm" />
						</p:selectOneMenu>
					</h:panelGroup>
				</h:panelGroup>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="Container50 Responsive50">
				<h:panelGroup layout="block" style="/*margin-top: 5%;*/"
					styleClass="Container30">
					<h:panelGroup layout="block" styleClass="ContainerIndentLabel">
						<p:outputLabel for="statusSelectOneMenu"
							value="#{messages.specification_import_status_label}" />
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup layout="block" style="/*margin-top: 5%;*/"
					styleClass="Container70">
					<h:panelGroup layout="block" styleClass="ContainerIndent">
						<p:selectOneMenu id="statusSelectOneMenu"
							value="#{jJTaskBean.importStatus}" effect="fade"
							filter="#{!loginBean.mobile}" filterMatchMode="contains"
							converter="com.starit.janjoonweb.ui.mb.converter.JJStatusConverter"
							disabled="#{jJTaskBean.disabledFilter}">

							<f:selectItem itemValue="#{null}"
								itemLabel="#{messages.importTask_selectStatus}" />
							<f:selectItems value="#{jJTaskBean.importStatusList}" var="p"
								itemLabel="#{loginBean.checkMessage(p)}" itemValue="#{p}" />
							<p:ajax process="@this" partialSubmit="true"
								listener="#{jJTaskBean.handleSelectStatus}"
								onstart="PF('taskBlockUIWidget').block()"
								oncomplete="PF('taskBlockUIWidget').unblock()"
								update="importTaskDialogForm" />
						</p:selectOneMenu>
					</h:panelGroup>
				</h:panelGroup>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="Container50 Responsive50">
				<h:panelGroup layout="block" style="/*margin-top: 5%;*/"
					styleClass="Container30">
					<h:panelGroup layout="block" styleClass="ContainerIndentLabel">
						<p:outputLabel for="seeAll"
							value="#{messages.importTask_viewAll}: " />
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup layout="block" style="/*margin-top: 5%;*/"
					styleClass="Container70">
					<h:panelGroup layout="block" styleClass="ContainerIndentLabel">
						<p:selectBooleanCheckbox id="seeAll"
							value="#{jJTaskBean.checkAll}">
							<p:ajax update="importTaskDialogForm"
								listener="#{jJTaskBean.checkAll}"
								onstart="PF('taskBlockUIWidget').block()"
								oncomplete="PF('taskBlockUIWidget').unblock()" />
						</p:selectBooleanCheckbox>
					</h:panelGroup>
				</h:panelGroup>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="Container100 Responsive100">
				<h:panelGroup layout="block" styleClass="ContainerIndent">
					<p:dataTable id="importDataTable" var="format" scrollable="true"
						style="table-layout: fixed;" scrollHeight="300"
						emptyMessage="#{messages.label_notRecordFound}"
						rowKey="#{format.object.id}" rowSelectMode="checkbox"
						selection="#{jJTaskBean.selectedImportFormat}"
						value="#{jJTaskBean.importFormats}" editable="true"
						editMode="cell">

						<p:ajax event="rowSelectCheckbox"
							listener="#{jJTaskBean.copyObjetListener}"
							update=":importTaskDialogForm:importButtonSC importDataTable" />
						<p:ajax event="rowUnselectCheckbox"
							listener="#{jJTaskBean.copyObjetListener}"
							update=":importTaskDialogForm:importButtonSC importDataTable" />
						<p:ajax event="toggleSelect"
							listener="#{jJTaskBean.copyObjetsListener}"
							update=":importTaskDialogForm:importButtonSC importDataTable" />


						<f:facet name="header">
							<p:row>
								<p:column style="width: 60%"></p:column>
								<p:column style="width: 40%"
									rendered="#{jJTaskBean.objet != null}">
									<h:outputText
										value="Import #{messages['importTask_selectObject_'.concat(jJTaskBean.objet)]}"
										style="position: absolute;right: 10px;" />
								</p:column>
							</p:row>
						</f:facet>
						<p:column selectionMode="multiple"
							style="width: 20px;text-align:center;padding: 3px !important;" />
						<p:column style="width:35%">
							<f:facet name="header">							
								<h:outputText value="#{messages.importTask_headerTable_tasks}" />								
							</f:facet>			
							<h:outputText value="#{format.name}" id="reqContent" />
							<p:tooltip id="toolTipContent" for="reqContent" showEffect="fade"
								hideEffect="fade" style="width:300px"
								rendered="#{jJTaskBean.objet == 'requirement'}">
								<p:panelGrid style="width:300px">
									<f:facet name="header">
										<p:row>
											<p:column>
												<h:outputText style="font-weight: bold;"
													value="Requirement: #{format.object.name}" />
											</p:column>
										</p:row>
									</f:facet>
									<p:row>
										<p:column>
											<p:outputLabel style="font-weight: bold;" for="tolDesc"
												value="Description :" />
											<br />
											<h:outputText id="tolDesc" readonly="true" escape="false"
												styleClass="Gray" style="width:300px"
												value="#{format.object.description}" />
										</p:column>
									</p:row>
								</p:panelGrid>
							</p:tooltip>
						</p:column>

						<p:column style="width:25%" priority="6"
							headerText="#{messages.importTask_headerTable_startDate}">
							<p:cellEditor>
								<f:facet name="output">
									<p:calendar value="#{format.startDate}" readonlyInput="true"
										navigator="true" pattern="yyyy/MM/dd HH:mm" />
								</f:facet>
								<f:facet name="input">
									<p:calendar value="#{format.startDate}" readonlyInput="true"
										navigator="true" pattern="yyyy/MM/dd HH:mm">
									</p:calendar>

								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column style="width:20%;text-align: center;" priority="6"
							headerText="#{messages.importTask_headerTable_requirement}">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText styleClass="Fs16" value="#{format.taskType.name}" />
								</f:facet>
								<f:facet name="input">
									<p:autoComplete id="taskType" value="#{format.taskType}"
										size="20" itemValue="#{taskType}" scrollHeight="200"
										converter="com.starit.janjoonweb.ui.mb.converter.JJStatusConverter"
										dropdown="true" var="taskType" inputStyleClass="Fs14"
										itemLabel="#{taskType != null ? taskType.name : messages.label_select}"
										completeMethod="#{jJTaskBean.completeTaskType}" />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column style="width:20%;text-align: center;padding: 3px !important;"
							headerText="#{messages.importTask_headerTable_workload}">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{format.workload}" styleClass="Fs16" />

								</f:facet>
								<f:facet name="input">
									<p:spinner value="#{format.workload}"  size="3" stepFactor="1"
										min="0">
									</p:spinner>

								</f:facet>
							</p:cellEditor>
						</p:column>
					</p:dataTable>
				</h:panelGroup>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="EmptyBox5" />
			<h:panelGroup layout="block" styleClass="Container50 Responsive50 ">
				<h:panelGroup layout="block" styleClass="ContainerIndent">
					<p:commandButton id="importButtonSC" value="Import"
						onstart="PF('taskBlockUIWidget').block()"
						oncomplete="PF('taskBlockUIWidget').unblock()"
						disabled="#{empty jJTaskBean.selectedImportFormat}"
						actionListener="#{jJTaskBean.validateTaskField}" update="msg" />
				</h:panelGroup>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="Container50 Responsive50 ">
				<h:panelGroup layout="block" styleClass="ContainerIndent">
					<p:commandButton value="#{messages.label_cancel}"
						styleClass="GrayButton"
						oncomplete="PF('taskImportDialogWidget').hide()" />
				</h:panelGroup>
			</h:panelGroup>
		</h:panelGroup>
	</h:form>
</ui:composition>
</html>
