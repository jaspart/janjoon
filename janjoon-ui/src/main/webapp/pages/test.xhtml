<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:pe="http://primefaces.org/ui/extensions">

<ui:composition template="../templates/layout.xhtml">
	<ui:define name="content">

		<f:event type="preRenderComponent"
			oncomplete="PF('blockUIWidget').unblock()"
			listener="#{jJTestcaseBean.loadData()}" />


		<p:layout styleClass="content"
			style="min-height:500px;overflow:hidden !important;height:700px !important;"
			stateful="true">

			<p:layoutUnit position="north" style="min-height:30px;">
				<h:form id="testFormNorth">
					<ui:repeat value="#{jJTestcaseBean.categoryList}" var="category">
						<p:commandButton value="#{category.name}"
							update=":testFormWest :testFormCenter"
							action="#{jJTestcaseBean.loadData()}"
							onstart="PF('blockUIWidget').block()"
							oncomplete="PF('blockUIWidget').unblock()">
							<f:setPropertyActionListener value="#{category}"
								target="#{jJTestcaseBean.category}" />
							<f:setPropertyActionListener target="#{jJTestcaseBean.project}"
								value="#{null}" />
						</p:commandButton>
					</ui:repeat>

					<p:commandButton value="#{messages.specification_video_help_title}"
						id="videoHelpBtn" icon="ui-icon-video"
						onclick="PF('videoHelpWidget').show()"
						style="float:none;position:relative;left:30%;" type="button" />


				</h:form>
			</p:layoutUnit>

			<p:layoutUnit position="west"
				style="min-width:200px;min-height:500px;height:600px !important;"
				resizable="true">
				<h:form id="testFormWest">
					<p:panelGrid>
						<p:row>
							<p:column>
								<h:outputText for="build" value="#{messages.test_build_label}" />
								<p:selectOneMenu id="build" value="#{jJBuildBean.build}"
									panelStyle="width:150px;" effect="fade" style="width:150px;"
									filter="true" filterMatchMode="startsWith">
									<f:converter
										converterId="com.starit.janjoonweb.ui.mb.converter.JJBuildConverter" />
									<f:selectItem itemValue="#{null}"
										itemLabel="#{messages.test_build_select}" />
									<f:selectItems value="#{jJBuildBean.builds}" var="c"
										itemLabel="#{c.name}" itemValue="#{c}" />
									<p:ajax process="@this" partialSubmit="true"
										listener="#{jJTestcaseBean.createTestcaseTree()}"
										update=":testFormWest :testFormCenter "
										onstart="PF('blockUIWidget').block()"
										oncomplete="PF('blockUIWidget').unblock()" />
								</p:selectOneMenu>
							</p:column>
							<p:column>
								<h:commandLink id="exportPDF"
									title="#{messages.test_export_tooltip}"
									disabled="#{jJTestcaseBean.disabledExport}"
									style="float: right;">
									<p:graphicImage value="/resources/images/pdf.png" />
									<p:dataExporter type="pdf"
										target=":testFormCenter:testcaseRecapDataTable"
										fileName="#{jJTestcaseBean.namefile}"
										preProcessor="#{jJTestcaseBean.preProcessPDF}" />
								</h:commandLink>
							</p:column>
						</p:row>
						<p:row>
							<p:column colspan="2">
								<p:tree id="testCaseTree" value="#{jJTestcaseBean.rootNode}"
									var="node" selectionMode="single"
									selection="#{jJTestcaseBean.selectedNode}" dynamic="true">
									<p:ajax event="select"
										listener="#{jJTestcaseBean.onNodeSelect}"
										update=":testFormCenter" onstart="PF('blockUIWidget').block()"
										oncomplete="PF('blockUIWidget').unblock()" />

									<p:treeNode>
										<h:outputText value="#{node}" styleClass="TestcaseChapter" />
									</p:treeNode>

									<p:treeNode type="TWT">
										<h:outputText value="#{node}"
											styleClass="TestcaseWithoutTeststep" />
									</p:treeNode>

									<p:treeNode type="TNE">
										<h:outputText value="#{node}" styleClass="TestcaseNotExecuted" />
									</p:treeNode>

									<p:treeNode type="TF">
										<h:outputText value="#{node}" styleClass="TestcaseFailed" />
									</p:treeNode>

									<p:treeNode type="TFWB">
										<h:outputText value="#{node}"
											styleClass="TestcaseFailedWithoutBuild" />
									</p:treeNode>

									<p:treeNode type="TS">
										<h:outputText value="#{node}" styleClass="TestcaseSuccess" />
									</p:treeNode>

									<p:treeNode type="TSWB">
										<h:outputText value="#{node}"
											styleClass="TestcaseSuccessWithoutBuild" />
									</p:treeNode>

									<p:treeNode type="TNF">
										<h:outputText value="#{node}" styleClass="TestcaseNonFini" />
									</p:treeNode>

									<p:treeNode type="TNFWB">
										<h:outputText value="#{node}"
											styleClass="TestcaseNonFiniWithoutBuild" />
									</p:treeNode>
								</p:tree>
							</p:column>
						</p:row>
					</p:panelGrid>
				</h:form>
			</p:layoutUnit>
			<p:layoutUnit position="center" resizable="false"
				style="min-height:500px;width:1060px !important;height:600px !important;">
				<h:form id="testFormCenter">
					<p:commandButton id="colorBtn" icon="ui-icon-info" type="button"
						style="float: right;" />
					<p:overlayPanel id="colorPanel" for="colorBtn" hideEffect="fade">
						<p:panelGrid>
							<f:facet name="header">
								<p:row>
									<p:column colspan="12">#{messages.test_color_title}</p:column>
								</p:row>
							</f:facet>
							<p:row>
								<p:column colspan="2" styleClass="TestcaseSuccess">
									<p:outputLabel
										value="#{messages.test_color_TestcaseSuccess_title}" />
								</p:column>

								<p:column colspan="2" styleClass="TestcaseFailed">
									<p:outputLabel
										value="#{messages.test_color_TestcaseFailed_title}" />
								</p:column>

								<p:column colspan="2" styleClass="TestcaseNotExecuted">
									<p:outputLabel
										value="#{messages.test_color_TestcaseNotExecuted_title}" />
								</p:column>
							</p:row>
							<p:row>
								<p:column colspan="2" styleClass="TestcaseWithoutTeststep">
									<p:outputLabel
										value="#{messages.test_color_TestcaseNotExecuted_title}" />
								</p:column>

								<p:column colspan="2" styleClass="TestcaseNonFini">
									<p:outputLabel
										value="#{messages.test_color_TestcaseNonFini_title}" />
								</p:column>

								<p:column colspan="2" styleClass="TestcaseChapter">
									<p:outputLabel
										value="#{messages.test_color_TestcaseChapter_title}" />
								</p:column>
							</p:row>
							<p:row>
								<p:column colspan="2" styleClass="TestcaseFailedWithoutBuild">
									<p:outputLabel
										value="#{messages.test_color_TestcaseFailedWithoutBuild_title}" />
								</p:column>

								<p:column colspan="2" styleClass="TestcaseNonFiniWithoutBuild">
									<p:outputLabel
										value="#{messages.test_color_TestcaseNonFiniWithoutBuild_title}" />
								</p:column>

								<p:column colspan="2" styleClass="TestcaseSuccessWithoutBuild">
									<p:outputLabel
										value="#{messages.test_color_TestcaseSuccessWithoutBuild_title}" />
								</p:column>
							</p:row>
						</p:panelGrid>
					</p:overlayPanel>

					<h:outputText value="#{messages.test_select_alert}"
						rendered="#{jJTestcaseBean.rendredEmptySelection}"
						style="color: red;" />

					<p:dataTable var="rowName" value="#{jJTestcaseBean.rowNames}" scrollable="true" scrollHeight="500"
						rowIndexVar="rowIdx" style="table-layout: fixed;width:#{jJTestcaseBean.width}px"
						rendered="#{!jJTestcaseBean.rendredTestCaseRecaps and !jJTestcaseBean.rendredTestCaseHistorical and jJTestcaseBean.rowNames != null}">
						<p:column headerText="Build/Version" styleClass="ui-widget-header" width="100">
							<h:outputText value="#{rowName.name}" />
						</p:column>

						<p:columns var="columnName" value="#{jJTestcaseBean.colNames}" width="50"
							headerText="#{columnName.name}" columnIndexVar="colIdx">

							<p:panel>
								<p:selectBooleanCheckbox value="false" disabled="true"
									rendered="#{rowName.testcase == null}" />
								<p:selectBooleanCheckbox
									value="#{rowName.testcase == columnName}" disabled="true"
									rendered="#{rowName.testcase != null}" />
							</p:panel>

						</p:columns>
					</p:dataTable>

					<p:panelGrid columns="1"
						rendered="#{jJTestcaseBean.rendredTestCaseRecaps}"
						style="float: right;width: 40%;margin-right: 20px;">
						<f:facet name="header">
								#{messages.test_requirement_progressBarHeader}
						</f:facet>
						<p:progressBar id="completion"
							rendered="#{jJTestcaseBean.rendredTestCaseRecaps}"
							value="#{jJTestcaseBean.reqCoverage}"
							labelTemplate="#{messages.specification_completion_progress} {value}%"
							displayOnly="true" />
					</p:panelGrid>
					<p:dataTable id="testcaseRecapDataTable" var="tcr"
						paginatorPosition="bottom"
						value="#{jJTestcaseBean.testCaseRecaps}" paginator="true" rows="5"
						style="width:550px;" rowKey="#{tcr.testcase.name}"
						rendered="#{jJTestcaseBean.rendredTestCaseRecaps}">
						<f:facet name="header">
							<h:outputText value="#{jJTestcaseBean.chapter.name}" />
						</f:facet>
						<p:column exportable="false">
							<f:facet name="header">
								<h:outputText value="#{messages.test_table_testcase_title}" />
							</f:facet>
							<h:outputText value="#{tcr.testcase.name}" />
						</p:column>
						<p:column exportable="false">
							<f:facet name="header">
								<h:outputText value="#{messages.test_table_status_title}" />
							</f:facet>
							<h:outputText value="#{tcr.status}" />
						</p:column>

						<p:column styleClass="action-column">
							<f:facet name="header">
								<h:outputText value="#{messages.test_table_action_title}" />
							</f:facet>
							<p:commandButton id="runButton" icon="ui-icon-play" 
								oncomplete="PF('runTestcaseDialogWidget').show()"
								action="#{jJTestcaseBean.runTestcase(jJTestcaseexecutionBean,jJTeststepexecutionBean)}"
								update=":runTestcaseDialog" disabled="#{tcr.disabled or !loginBean.authorisationService.xTest}">
								<f:setPropertyActionListener value="#{tcr.testcase}"
									target="#{jJTestcaseBean.testcase}" />
							</p:commandButton>
							<p:tooltip for="runButton" value="Run #{tcr.testcase.name}"
								showEffect="fade" hideEffect="fade" />
							<p:commandButton id="editButton" icon="ui-icon-pencil"
								oncomplete="PF('testcaseDialogWidget').show()"
								action="#{jJTestcaseBean.editTestcase(jJTeststepBean)}"
								update=":testcaseDialog" disabled="#{!loginBean.authorisationService.wTest}">
								<f:setPropertyActionListener value="#{tcr.testcase}"
									target="#{jJTestcaseBean.testcase}" />
							</p:commandButton>
							<p:tooltip for="editButton" value="#{messages.label_edit}"
								showEffect="fade" hideEffect="fade" />
						</p:column>
						<f:facet name="footer">
							<p:commandButton value="#{messages.test_create_button}"
								id="newTestcase" disabled="#{!loginBean.authorisationService.wTest}"
								actionListener="#{jJTestcaseBean.newTestcase(jJTeststepBean)}"
								update=":testcaseDialog"
								oncomplete="PF('testcaseDialogWidget').show()"
								icon="ui-icon-circle-plus" />
						</f:facet>
					</p:dataTable>

					<p:lineChart id="filled" value="#{chartBean.categoryModel}"
						legendPosition="ne" title="#{messages.test_graph_testcase_title}"
						seriesColors="#{chartBean.seriesColors}"
						style="height:300px;margin-top:20px;"
						xaxisLabel="#{messages.test_graph_ordinate_label}"
						yaxisLabel="#{messages.test_graph_abscissa_label}" animate="true"
						rendered="#{jJTestcaseBean.rendredTestCaseRecaps}" />

					<p:dataTable id="teststepRecapDataTable" paginatorPosition="bottom"
						value="#{jJTeststepBean.teststeps}" rowKey="#{ts.name}" var="ts"
						rendered="#{jJTestcaseBean.rendredTestCaseHistorical}"
						paginator="true" rows="8" style="width:650px;">
						<f:facet name="header">
							<p:row>
								<p:column>
									<h:outputText
										value="TC #{jJTestcaseBean.testcase.ordering}: #{jJTestcaseBean.testcase.name}" />
									<br />
								</p:column>
								<p:column>
									<h:outputText
										value=" Requirement: #{jJTestcaseBean.testcase.requirement.name}" />
									<br />
								</p:column>
								<p:column>
									<p:commandButton id="editButton" icon="ui-icon-pencil"
										oncomplete="PF('testcaseDialogWidget').show()" disabled="#{!loginBean.authorisationService.wTest}"
										action="#{jJTestcaseBean.editTestcase(jJTeststepBean)}"
										update=":testcaseDialog" />
									<p:tooltip for="editButton" value="#{messages.label_edit}"
										showEffect="fade" hideEffect="fade" />
									<p:commandButton id="runButton" icon="ui-icon-play"
										oncomplete="PF('runTestcaseDialogWidget').show()"
										actionListener="#{jJTestcaseBean.runTestcase(jJTestcaseexecutionBean,jJTeststepexecutionBean)}"
										update=":runTestcaseDialog"
										disabled="#{jJBuildBean.build == null or !loginBean.authorisationService.xTest}">
										<f:setPropertyActionListener
											value="#{jJTestcaseBean.testcase}"
											target="#{jJTestcaseBean.testcase}" />
									</p:commandButton>
								</p:column>
							</p:row>

						</f:facet>

						<p:column headerText="Order">
							<h:outputText value="#{ts.ordering}" />
						</p:column>

						<p:column headerText="Action">
							<h:outputText value="#{ts.actionstep}" />
						</p:column>
						<p:column headerText="Result">
							<h:outputText value="#{ts.resultstep}" />
						</p:column>
					</p:dataTable>

					<p:dataTable id="testexecutionRecapDataTable"
						value="#{jJTestcaseexecutionBean.testCaseexecutionRecaps}"
						rowKey="#{tce.name}" var="tce" paginatorPosition="bottom"
						rendered="#{jJTestcaseBean.rendredTestCaseHistorical}"
						paginator="true" rows="8" style="width:650px;">
						<p:column headerText="Id">
							<h:outputText value="#{tce.testcaseexecution.id}" />
						</p:column>
						<p:column headerText="Build">
							<h:outputText value="#{tce.testcaseexecution.build.name}" />
						</p:column>
						<p:column headerText="Creation Date">
							<h:outputText value="#{tce.testcaseexecution.creationDate}" />
						</p:column>
						<p:column headerText="Update Date">
							<h:outputText value="#{tce.testcaseexecution.updatedDate}" />
						</p:column>
						<p:column headerText="Status">
							<h:outputText value="#{tce.status}" />
						</p:column>
					</p:dataTable>
				</h:form>

			</p:layoutUnit>
		</p:layout>

		<p:hotkey bind="esc" handler="PF('videoHelpWidget').hide()" />
		<p:dialog id="videoHelpDialog" widgetVar="videoHelpWidget"
			position="center" header="#{messages.specification_video_help_title}"
			style="padding:0px;" resizable="false" draggable="false"
			minHeight="500" minWidth="500" showEffect="fade" hideEffect="fade">
			<video width="100%" height="100%" controls="true">
				<source src="https://www.starit.fr/jjtraining.mp4" type="video/mp4" />
			</video>
		</p:dialog>

		<p:hotkey bind="esc" handler="PF('testcaseDialogWidget').hide()" />
		<p:dialog id="testcaseDialog"
			header="#{messages[jJTestcaseBean.message]}" modal="true"
			widgetVar="testcaseDialogWidget" dynamic="true" resizable="false"
			style="top: 30px;">
			<p:ajax event="close" update=":testFormCenter :testFormWest"
				listener="#{jJTestcaseBean.closeDialog}" />
			<p:outputPanel id="testcaseDialogPanel">
				<h:form id="testcaseDialogForm">
					<p:growl id="msg" />
					<p:scrollPanel style="width:720px;height:500px;" mode="native">
						<p:panelGrid style="margin-top:10px;">
							<p:row>
								<p:column>
									<p:inputText id="name" value="#{jJTestcaseBean.testcase.name}"
										required="true" widgetVar="nameWidget"
										label="#{messages.test_new_name_label}"
										requiredMessage="#{messages.test_new_name_alert}"
										disabled="#{jJTestcaseBean.disabledTestcaseMode}">
										<f:validateLength maximum="100" />
									</p:inputText>
									<p:watermark for="name"
										value="#{messages.test_new_name_watermark}" />
								</p:column>
								<p:column>
									<h:outputText for="requirement"
										value="#{messages.test_new_requirement_label}" />
									<p:selectOneMenu id="requirement"
										value="#{jJTestcaseBean.requirement}"
										panelStyle="width:150px;" effect="fade" style="width:150px;"
										filter="true" required="true" filterMatchMode="startsWith"
										widgetVar="requirementWidget"
										disabled="#{jJTestcaseBean.disabledTestcaseMode}"
										requiredMessage="#{messages.test_new_name_alert}">
										<f:converter
											converterId="com.starit.janjoonweb.ui.mb.converter.JJRequirementConverter" />
										<f:selectItem itemLabel="#{jJTestcaseBean.requirement.name}"
											itemValue="#{jJTestcaseBean.requirement}" />
										<f:selectItems value="#{jJTestcaseBean.requirements}" var="c"
											itemLabel="#{c.name}" itemValue="#{c}" />
										<p:ajax process="@this" partialSubmit="true"
											listener="#{jJTestcaseBean.handleSelectRequirement()}" />
									</p:selectOneMenu>
								</p:column>
								<p:column>
									<h:outputText value="#{messages.test_new_automatic_label}" />
									<p:selectBooleanCheckbox
										disabled="#{jJTestcaseBean.disabledTestcaseMode}"
										value="#{jJTestcaseBean.testcase.automatic}">
										<p:ajax listener="#{jJTestcaseBean.addMessage}" />
									</p:selectBooleanCheckbox>
								</p:column>
							</p:row>
							<p:row>
								<p:column colspan="3">
									<h:outputText value="#{messages.test_new_description_label}" />
									<pe:ckEditor id="description" widgetVar="descriptionWidget"
										style="width:680px;"
										customConfig="#{request.contextPath}/resources/js/ckEditor.js"
										readOnly="#{jJTestcaseBean.disabledTestcaseMode}"
										toolbar="[['Bold','Italic','Underline','Strike','NumberedList','BulletedList','Image','TextColor','BGColor']]"
										value="#{jJTestcaseBean.testcase.description}" required="true"
										requiredMessage="#{messages.test_new_description_alert}" />
								</p:column>
							</p:row>
							<p:row>
								<p:column>
									<h:outputText value="#{messages.test_new_task_label}" />
									<p:selectBooleanCheckbox id="initiateTask"
										value="#{jJTestcaseBean.initiateTask}"
										disabled="#{jJTestcaseBean.disabledInitTask}">
										<p:ajax listener="#{jJTestcaseBean.loadTask()}"
											update="outputPanel" />
									</p:selectBooleanCheckbox>
								</p:column>
								<p:column>
									<h:outputLabel for="workload"
										value="#{messages.test_new_workload_label}" />
									<p:outputPanel id="outputPanel">
										<p:spinner id="workload"
											value="#{jJTestcaseBean.task.workloadPlanned}" stepFactor="1"
											min="0" disabled="#{jJTestcaseBean.disabledTask}">
											<p:ajax update="workloadvalue" process="@this" />
										</p:spinner>
										<h:outputText id="workloadvalue"
											value="#{jJTestcaseBean.task.workloadPlanned} #{messages.test_new_increment_label}" />
									</p:outputPanel>
								</p:column>
								<p:column>
									<p:commandButton id="addTestcase"
										value="#{messages.test_new_addtest_label}"
										disabled="#{not jJTestcaseBean.disabledTeststepMode}"
										icon="ui-icon-circle-plus"
										actionListener="#{jJTestcaseBean.save()}"
										process="@this,name,requirement,description "
										update="testcaseDialogForm :testFormWest" />
								</p:column>
							</p:row>
							<p:row>
								<p:column>
									<h:outputText for="action"
										value="#{messages.test_new_action_label}*" />
									<p:inputText id="action"
										value="#{jJTeststepBean.teststep.actionstep}"
										disabled="#{jJTestcaseBean.disabledTeststepMode}"
										label="#{messages.test_new_action_label}" required="true"
										requiredMessage="#{messages.test_new_action_alert}"
										widgetVar="actionWidget" />
								</p:column>
								<p:column>
									<h:outputText for="result"
										value="#{messages.test_new_result_label}*" />
									<p:inputText id="result"
										value="#{jJTeststepBean.teststep.resultstep}"
										disabled="#{jJTestcaseBean.disabledTeststepMode}"
										label="#{messages.test_new_result_label}" required="true"
										requiredMessage="#{messages.test_new_result_alert}"
										widgetVar="resultWidget" />
								</p:column>
								<p:column>
									<p:commandButton id="addTestStep"
										value="#{messages.test_new_addteststep_label}"
										disabled="#{jJTestcaseBean.disabledTeststepMode}"
										actionListener="#{jJTeststepBean.save()}"
										icon="ui-icon-circle-plus"
										update="action result testStepDataTable msg "
										process="@this,action,result" />
								</p:column>
							</p:row>
						</p:panelGrid>
						<p:dataTable id="testStepDataTable" var="ts"
							value="#{jJTeststepBean.teststeps}" scrollRows="10"
							scrollable="true" scrollHeight="100" style="width:700px;"
							rowKey="#{ts.name}" editable="true">
							<p:ajax event="rowEdit" listener="#{jJTeststepBean.editTestStep}"
								update=":testcaseDialogForm:msg"
								process="@this,actionInputWidget,resultInputWidget" />
							<p:ajax event="rowEditCancel"
								listener="#{jJTeststepBean.cancelEditTestStep}"
								update=":testcaseDialogForm:msg" />
							<f:facet name="header">  
            						#{messages.test_new_teststep_title}  
        					</f:facet>
							<p:column headerText="#{messages.test_new_table_order_label}"
								style="width:9%;">
								<h:outputText value="#{ts.ordering}" />
							</p:column>
							<p:column headerText="#{messages.test_new_table_action_header}"
								style="width:33%;">
								<p:cellEditor>
									<f:facet name="output">
										<h:outputText value="#{ts.actionstep}" />
									</f:facet>
									<f:facet name="input">
										<p:inputText value="#{ts.actionstep}" style="width:90%"
											required="true"
											label="#{messages.test_new_table_action_label}"
											id="actionInputWidget"
											requiredMessage="#{messages.test_new_table_action_alert}">
										</p:inputText>
									</f:facet>
								</p:cellEditor>
							</p:column>
							<p:column headerText="#{messages.test_new_table_result_header}"
								style="width:33%;">
								<p:cellEditor>
									<f:facet name="output">
										<h:outputText value="#{ts.resultstep}" />
									</f:facet>
									<f:facet name="input">
										<p:inputText value="#{ts.resultstep}" style="width:90%"
											required="true"
											label="#{messages.test_new_table_result_label}"
											id="resultInputWidget"
											requiredMessage="#{messages.test_new_table_result_alert}">
										</p:inputText>
									</f:facet>
								</p:cellEditor>
							</p:column>
							<p:column headerText="#{messages.test_new_table_actions_label}"
								style="width:15%;">
								<p:commandButton id="insertTestStep" update="testStepDataTable"
									action="#{jJTeststepBean.insertTestStep()}"
									icon="ui-icon-circle-triangle-n" process="@this"
									style="align:center;">
									<f:setPropertyActionListener value="#{ts}"
										target="#{jJTeststepBean.teststep}" />
								</p:commandButton>
								<p:tooltip for="insertTestStep"
									value="#{messages.test_new_teststep_insert_tooltip}"
									showEffect="fade" hideEffect="fade" />

								<p:commandButton id="deleteTestStep" update="testStepDataTable"
									action="#{jJTeststepBean.deleteTestStep()}"
									icon="ui-icon-circle-minus" process="@this"
									style="align:center;">
									<f:setPropertyActionListener value="#{ts}"
										target="#{jJTeststepBean.teststep}" />
								</p:commandButton>
								<p:tooltip for="deleteTestStep"
									value="#{messages.test_new_teststep_delete_tooltip}"
									showEffect="fade" hideEffect="fade" />
							</p:column>
							<p:column style="width:10%;">
								<p:rowEditor />
							</p:column>
						</p:dataTable>
					</p:scrollPanel>
					<p:commandButton id="saveButton" value="Save"
						process="@this,name,requirement,description"
						disabled="#{jJTestcaseBean.disabledTeststepMode}"
						update="testcaseDialogForm :testFormWest" style="float: right;"
						action="#{jJTestcaseBean.saveAndclose(jJTeststepBean)}" />
				</h:form>
			</p:outputPanel>
		</p:dialog>

		<p:dialog id="runTestcaseDialog" header="#{messages.test_exec_title}"
			modal="true" widgetVar="runTestcaseDialogWidget" draggable="false"
			height="360px" dynamic="true" resizable="false"
			style="width :370px !important">
			<p:hotkey bind="esc" handler="PF('testcaseDialogWidget').hide()" />
			<p:hotkey bind="space" handler="TestcaseExecSuccessButton.jq.click()" />
			<p:hotkey bind="S" handler="TestcaseExecSuccessButton.jq.click()" />
			<p:hotkey bind="F" handler="TestcaseExecFailedButton.jq.click()" />
			<p:ajax event="close" update=":testFormCenter :testFormWest"
				listener="#{jJTeststepexecutionBean.closeDialog()}" />
			<p:outputPanel id="runTestcaseDialogPanel">
				<h:form id="runForm">
					<p:growl id="msg" />

					<p:tabView id="teststepTabView" widgetVar="teststepTabViewWidget"
						activeIndex="#{jJTeststepexecutionBean.activeIndex}"
						scrollable="true" dynamic="true"
						value="#{jJTeststepexecutionBean.teststepexecutions}" var="tse">
						<p:ajax event="tabChange"
							listener="#{jJTeststepexecutionBean.onTabChange}"
							update="teststepTabView :runForm:testcaseexecutionStatus :runForm:validateButton" />
						<p:tab title="#{tse.teststep.ordering}">
							<p:panelGrid>
								<p:row>
									<p:column>
										<h:outputText value="#{messages.test_exec_action_label}" />
									</p:column>
									<p:column>
										<h:outputText value="#{messages.test_exec_result_label}" />
									</p:column>
								</p:row>
								<p:row>
									<p:column>
										<p:scrollPanel mode="native" style="height:150px;width:130px;">
											<h:outputText escape="true"
												value="#{tse.teststep.actionstep}" />
										</p:scrollPanel>
									</p:column>
									<p:column>
										<p:scrollPanel mode="native" style="height:150px;width:130px;">
											<h:outputText escape="true"
												value="#{tse.teststep.resultstep}" />
										</p:scrollPanel>
									</p:column>
								</p:row>
								<p:row>
									<p:column>
										<h:outputText value="Status: " />
									</p:column>
									<p:column>
										<p:commandButton id="testExecSuccessButton"
											disabled="#{tse.passed != null}"
											value="#{messages.test_graph_success_label}"
											icon="ui-icon-circle-check" styleClass="TestcaseExecSuccess"
											actionListener="#{jJTeststepexecutionBean.setStatus('true')}"
											action="#{jJTeststepexecutionBean.handleStatus()}"
											widgetVar="TestcaseExecSuccessButton"
											update="teststepTabView :runForm:testcaseexecutionStatus :runForm:validateButton :bugForm:createPanelGrid"
											async="true" ajax="true" />
										<p:commandButton id="testExecFailedButton"
											disabled="#{tse.passed != null}"
											value="#{messages.test_graph_failed_label}"
											icon="ui-icon-circle-close" styleClass="TestcaseExecFailed"
											actionListener="#{jJTeststepexecutionBean.setStatus('false')}"
											action="#{jJTeststepexecutionBean.handleStatus()}"
											widgetVar="TestcaseExecFailedButton"
											update="teststepTabView :runForm:testcaseexecutionStatus :runForm:validateButton :bugForm:createPanelGrid"
											async="true" ajax="true" />

										<p:remoteCommand name="remoteButton" update=":runForm" />
									</p:column>
								</p:row>
							</p:panelGrid>
						</p:tab>
					</p:tabView>

					<p:panelGrid
						rendered="#{!jJTeststepexecutionBean.disabledTestcase}">
						<p:row>
							<p:column>
								<p:selectOneButton id="testcaseexecutionStatus"
									value="#{jJTestcaseexecutionBean.status}"
									disabled="#{jJTeststepexecutionBean.disabledTestcase}">
									<p:ajax listener="#{jJTestcaseexecutionBean.handleStatus()}" />
									<f:selectItem itemValue="true"
										itemLabel="#{messages.test_exec_status_passed_label}" />
									<f:selectItem itemValue="false"
										itemLabel="#{messages.test_exec_status_failed_label}" />
								</p:selectOneButton>
							</p:column>
							<p:column>
								<p:commandButton id="validateButton"
									value="#{messages.test_exec_valid_label}"
									icon="ui-icon-circle-check"
									update=":testFormCenter :testFormWest"
									actionListener="#{jJTeststepexecutionBean.validateTab}"
									style="float: right;"
									disabled="#{jJTeststepexecutionBean.disabledTestcase}" />
							</p:column>
						</p:row>
					</p:panelGrid>
				</h:form>
			</p:outputPanel>
		</p:dialog>

		<p:dialog header="#{messages.bug_create_title}" modal="true"
			widgetVar="bugTestDialogWidget" dynamic="true" resizable="true"
			maximizable="true" showEffect="fade" hideEffect="explode"
			style="top: 30px;">
			<p:ajax event="close" listener="#{jJBugBean.handleDialogClose}" />
			<p:outputPanel id="createPanel">
				<h:form id="bugForm" enctype="multipart/form-data">
					<ui:include src="bugDialog.xhtml">
						<ui:param name="JJBug_" value="#{jJTeststepexecutionBean.bug}" />
					</ui:include>
					<p:commandButton id="saveBug" value="#{messages.label_save}"
						action="#{jJBugBean.saveBug}"
						update=":runForm:teststepTabView :runForm:testcaseexecutionStatus :runForm:validateButton"
						oncomplete="PF('bugTestDialogWidget').hide()" />
				</h:form>
			</p:outputPanel>
		</p:dialog>

	</ui:define>
</ui:composition>
</html>