<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<ui:composition template="../templates/layout.xhtml">
	<ui:define name="content">
		<p:panel id="mainPanel" toggleable="true" toggleSpeed="250">
			<p:growl id="notif" showDetail="true" life="2000" />
			<p:growl id="dev" showDetail="true" life="2000" />
			<f:facet name="header">
				<h:outputFormat value="#{messages.main_welcome_title}">
					<f:param value="#{messages.label_appName}" />
				</h:outputFormat>
			</f:facet>
			<p />
			<h:outputText id="welcomeText" value="#{messages.label_welcome_text}" />
			<p />

		</p:panel>
		<br />
		<p:panel id="dataPanel" rendered="#{loginBean.enable}"
			header="#{messages.main_communication_title}">
			<f:event listener="#{jJMessageBean.initJJmessageTable}"
				type="preRenderView" />
			<h:form id="messageForm">
				<p:dataTable id="MessageTable2" sortMode="multiple"
					value="#{jJMessageBean.mainMessages}" rowKey="#{mes.id}" var="mes"
					widgetVar="messageTable" scrollable="true" scrollHeight="200"
					filteredValue="#{jJMessageBean.filteredJJMessage}"
					emptyMessage="#{messages.label_notFound}">
					<f:facet name="header">
						<p:outputPanel>
							<h:outputText value="#{messages.main_communication_search_label}" />
							<p:inputText id="globalFilter"
								onkeyup="PF('messageTable').filter()" style="width:200px"
								placeholder="#{messages.main_communication_search_watermark}" />
						</p:outputPanel>
					</f:facet>
					<p:column headerText="#{messages.main_communication_message_title}"
						filterBy="message" filterMatchMode="contains" sortBy="message"
						filterStyle="width: 90%;"
						style="width: 10% !important;height: 5px !important;">
						<h:outputText style="width: 90% !important;"
							value="#{mes.message}" />
					</p:column>
					<p:column headerText="#{messages.main_communication_project_title}"
						filterBy="project.name" sortBy="project.name"
						filterOptions="#{jJMessageBean.projectOptions}"
						filterMatchMode="exact" filterStyle="width: 90%;"
						style="width: 6% !important;height: 5px !important;">
						<h:outputText value="#{mes.project.name}" />
					</p:column>
					<p:column headerText="#{messages.main_communication_product_title}"
						filterBy="product.name" sortBy="product.name"
						filterOptions="#{jJMessageBean.productOptions}"
						filterMatchMode="exact" filterStyle="width: 90%;"
						style="width: 6% !important;height: 5px !important;">
						<h:outputText value="#{mes.product.name}" />
					</p:column>
					<p:column headerText="#{messages.main_communication_creator_title}"
						filterBy="createdBy.name" sortBy="createdBy.name"
						filterOptions="#{jJMessageBean.creatorOptions}"
						filterMatchMode="exact" filterStyle="width: 90%;"
						style="width: 6% !important;height: 5px !important;">
						<h:outputText value="#{mes.createdBy.name}" />
					</p:column>
					<p:column
						headerText="#{messages.main_communication_criticity_title}"
						filterBy="criticity.name" sortBy="criticity.name"
						filterMatchMode="exact"
						style="width: 6% !important;height: 5px !important;"
						filterOptions="#{jJMessageBean.criticityOptions}"
						filterStyle="width: 90%;">
						<h:outputText value="#{mes.criticity.name}" />
					</p:column>
					<p:column headerText="#{messages.main_communication_status_title}"
						sortBy="status.name" filterBy="status.name"
						filterMatchMode="exact"
						filterOptions="#{jJMessageBean.statusOptions}"
						style="width: 6% !important;height: 5px !important;"
						filterStyle="width: 90%;">
						<h:outputText value="#{mes.status.name}" />
					</p:column>
					<p:column
						headerText="#{messages.main_communication_creation_title}"
						sortBy="creationDate"
						style="width: 6% !important;height: 5px !important;">
						<h:outputText value="#{mes.creationDate}">
							<f:converter converterId="extendedDateTimeConverter" />
							<f:attribute name="pattern" value="dd/MM/yyyy" />
							<f:attribute name="timeZone" value="UCL" />

						</h:outputText>
					</p:column>
					<p:column headerText="#{messages.main_communication_resolve_title}"
						style="width:5% !important;">
						<p:commandButton id="resolveButton"
							value="#{messages.main_communication_resolve_button}"
							oncomplete="resolveDialogWidget.show()"
							title="#{messages.label_disable}">
							<f:setPropertyActionListener value="#{mes}"
								target="#{jJMessageBean.resolvedJJMessage}" />
						</p:commandButton>
						<p:tooltip for="resolveButton" value="#{messages.label_disable}"
							showEffect="fade" hideEffect="fade" />
					</p:column>
				</p:dataTable>
			</h:form>
			<p:growl id="notifMPT" showDetail="true" life="2000" />
			<p:confirmDialog id="resolveDialog" widgetVar="resolveDialogWidget"
				message="#{messages.label_disable_record}" showEffect="fade"
				hideEffect="explode" header="#{messages.label_confirm_disabling}"
				severity="alarm">
				<p:outputPanel id="deletePanel">
					<h:form id="deleteForm">
						<p:commandButton id="deleteYesButton"
							value="#{messages.label_yes}"
							action="#{jJMessageBean.resolveJJMessage}"
							update=":messageForm,:notifMPT"
							oncomplete="resolveDialogWidget.hide()" />
						<p:commandButton id="deleteNoButton" value="#{messages.label_no}"
							onclick="resolveDialogWidget.hide()" type="button" />
					</h:form>
				</p:outputPanel>
			</p:confirmDialog>
		</p:panel>

		<p:panel id="taskPanel" rendered="#{loginBean.enable}"
			header="To do Tasks">
			<f:event listener="#{jJTaskBean.initToDoTasks}" type="preRenderView" />
			<h:form id="taskForm">
				<p:dataTable id="taskTable" value="#{jJTaskBean.toDoTasks}"
					rowKey="#{task.id}" var="task" widgetVar="taskTable"
					scrollable="true" scrollHeight="200"
					emptyMessage="There is no Task to do,See all in project View">

					<p:column headerText="Task" colspan="2">
						<h:outputText value="#{task}" converter="JJTaskConverter" />
					</p:column>

					<p:column headerText="Specification">
						<h:outputText value="#{task.requirement}"
							converter="JJRequirementConverter" />
					</p:column>

					<p:column headerText="Bug">
						<h:outputText value="#{task.bug}" converter="JJBugConverter" />
					</p:column>

					<p:column headerText="Project">

						<h:outputText value="#{task.requirement.project}"
							converter="JJProjectConverter"
							rendered="#{task.requirement != null}" />


						<h:outputText value="#{task.bug.project}"
							converter="JJProjectConverter"
							rendered="#{task.requirement == null and task.bug != null }" />

						<h:outputText value="#{task.sprint.project}"
							converter="JJProjectConverter"
							rendered="#{task.requirement == null and task.bug == null and task.sprint != null}" />

					</p:column>

					<p:column headerText="Start Date :">
						<h:outputText value="#{task.startDateReal}">
							<f:converter converterId="extendedDateTimeConverter" />
							<f:attribute name="pattern" value="dd/MM/yyyy" />
							<f:attribute name="timeZone" value="UCL" />
						</h:outputText>
					</p:column>


					<p:column headerText="WorkLoad">
						<h:outputText value="#{task.workloadPlanned}" />
					</p:column>

					<p:column styleClass="action-column"
						headerText="#{messages.bug_table_action_title}">
						<p:splitButton id="viewTaskButton" icon="ui-icon-zoomin"
							update=":viewTaskForm:viewTaskPanelGrid" immediate="true"
							action="#{jJTaskBean.initiateReqTreeNode}">
							<f:setPropertyActionListener value="#{task}"
								target="#{jJTaskBean.task}" />

						</p:splitButton>
					</p:column>
				</p:dataTable>
			</h:form>
			<p:dialog id="viewTaskDialog" header="#{messages.label_view} JJTask"
				modal="true" widgetVar="viewTaskDialogWidget" dynamic="true"
				resizable="true" maximizable="true" showEffect="fade"
				hideEffect="explode" draggable="false">
				<p:outputPanel id="viewTaskPanel">
					<h:form id="viewTaskForm" enctype="multipart/form-data">
						<ui:include src="taskDialog.xhtml">
							<ui:param name="JJTask_" value="#{jJTaskBean.task}" />
						</ui:include>
						<p:commandButton id="viewCloseButton"
							value="#{messages.label_close}"
							oncomplete="PF('blockUIWidget').unblock()"
							onclick="viewTaskDialogWidget.hide()" type="button" />
					</h:form>
				</p:outputPanel>
			</p:dialog>
		</p:panel>

		<p:panel id="specpanel" header="SpÃ©cification non couverte "
			rendered="#{loginBean.enable}">

			<f:event listener="#{jJRequirementBean.initNonCouvretSpec}"
				type="preRenderView" />
			<h:form id="specForm">
				<p:dataTable id="specTable"
					value="#{jJRequirementBean.noCouvretReq}" rowKey="#{req.id}"
					var="req" widgetVar="taskTable" scrollable="true"
					scrollHeight="200"
					emptyMessage="There is no Requirement non couvered,See all in Spec View">

					<p:column headerText="Specification" colspan="2">
						<h:outputText value="#{req}" converter="JJRequirementConverter" />
					</p:column>

					<p:column headerText="Chapter">
						<h:outputText value="#{req.chapter}"
							converter="JJChapterConverter" />
					</p:column>

					<p:column headerText="Project">
						<h:outputText value="#{req.project}"
							converter="JJProjectConverter" />

					</p:column>
							<p:column headerText="Category">
						<h:outputText value="#{req.category}"
							converter="JJCategoryConverter" />

					</p:column>

					<p:column headerText="Version">
						<h:outputText value="#{req.versioning}"
							converter="JJVersionConverter" />

					</p:column>

					<p:column headerText="Status">
						<h:outputText value="#{req.status}" converter="JJStatusConverter" />

					</p:column>
				</p:dataTable>
			</h:form>
		</p:panel>

	</ui:define>
</ui:composition>
</html>
