<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

<ui:composition template="../templates/template.xhtml">
	<ui:define name="head">
		<style type="text/css">
.ui-datalist-data {
	-webkit-padding-start: 0px;
}

.ui-datatable table {
	border-collapse: collapse;
	table-layout: fixed;
}

.ui-datatable-tablewrapper {
	margin: 0px;
}

.ui-datalist-item {
	padding: 3px;
}

.paginated .ui-datalist-data {
	padding-left: 10px;
}

.pe-timepicker-input {
	width: 100%;
}
</style>
	</ui:define>
	<ui:define name="content">
		<h:form>
			<p:remoteCommand name="updateAdmin" />
		</h:form>
		<h:panelGroup layout="block" styleClass="Container ui-fluid">
			<h:form id="configForm">

				<h:panelGroup layout="block" styleClass="Container100">
					<h:panelGroup layout="block" styleClass="Container60 Responsive100">
						<h:panelGroup layout="block" styleClass="ContainerIndent">
							<p:panel header="#{messages.contact_panel_header}"
								styleClass="Container100">
								<h:panelGroup layout="block" styleClass="EmptyBox5" />
								<h:panelGroup layout="block" styleClass="Container100">
									<h:panelGroup layout="block"
										styleClass="Container25 Responsive SoftGrayBack">
										<h:panelGroup layout="block" styleClass="Container100">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:graphicImage value="#{imageStreamer.image}" cache="false"
													height="100%" width="100%">
													<f:param name="contactId" value="#{loginBean.contact.id}" />
												</p:graphicImage>
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container100">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:commandButton
													onclick="PF('changePhotoDialogWidget').show()"
													value="Change" icon="fa fa-plus-square Fs20" />

											</h:panelGroup>
										</h:panelGroup>
									</h:panelGroup>
									<h:panelGroup layout="block"
										styleClass="Container75 Responsive100">
										<h:panelGroup layout="block" styleClass="Container100">
											<h:panelGroup layout="block" styleClass="Container40">
												<h:panelGroup layout="block"
													styleClass="ContainerIndentLabel">
													<p:outputLabel for="firstname"
														value="#{messages.contact_firstname}:" />
												</h:panelGroup>
											</h:panelGroup>
											<h:panelGroup layout="block" styleClass="Container60">
												<h:panelGroup layout="block" styleClass="ContainerIndent">

													<p:inputText id="firstname"
														value="#{jJContactBean.contactUtil.firstname}"
														required="true">
														<f:validateLength maximum="100" />
													</p:inputText>
												</h:panelGroup>
											</h:panelGroup>
										</h:panelGroup>

										<h:panelGroup layout="block" styleClass="Container100">
											<h:panelGroup layout="block" styleClass="Container40">
												<h:panelGroup layout="block"
													styleClass="ContainerIndentLabel">
													<p:outputLabel for="name" value="#{messages.contact_name}:" />
												</h:panelGroup>
											</h:panelGroup>
											<h:panelGroup layout="block" styleClass="Container60">
												<h:panelGroup layout="block" styleClass="ContainerIndent">
													<p:inputText id="name"
														value="#{jJContactBean.contactUtil.name}" required="true">
														<f:validateLength maximum="100" />
													</p:inputText>
												</h:panelGroup>
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container100">
											<h:panelGroup layout="block" styleClass="Container40">
												<h:panelGroup layout="block"
													styleClass="ContainerIndentLabel">
													<p:outputLabel for="email"
														value="#{messages.contact_email}:" />
												</h:panelGroup>
											</h:panelGroup>
											<h:panelGroup layout="block" styleClass="Container60">
												<h:panelGroup layout="block" styleClass="ContainerIndent">
													<p:inputText id="email"
														value="#{jJContactBean.contactUtil.email}" readonly="true" />
												</h:panelGroup>
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container100">
											<h:panelGroup layout="block" styleClass="Container40">
												<h:panelGroup layout="block"
													styleClass="ContainerIndentLabel">
													<p:outputLabel for="lastproject"
														value="#{messages.contact_lastproject}:" />
												</h:panelGroup>
											</h:panelGroup>
											<h:panelGroup layout="block" styleClass="Container60">
												<h:panelGroup layout="block" styleClass="ContainerIndent">
													<p:selectOneMenu id="lastproject"
														value="#{jJContactBean.contactUtil.lastProject}"
														effect="fade" filter="#{!loginBean.mobile}"
														filterMatchMode="contains"
														converter="com.starit.janjoonweb.ui.mb.converter.JJProjectConverter">

														<f:selectItem itemValue="#{null}"
															itemLabel="#{messages.contact_anyProject}" />
														<f:selectItems value="#{jJProjectBean.projectList}"
															var="p" itemLabel="#{p.name}" itemValue="#{p}" />
														<p:ajax onstart="PF('blockUIWidget').block()"
															oncomplete="PF('blockUIWidget').unblock()"
															update="configForm" />
													</p:selectOneMenu>
												</h:panelGroup>
											</h:panelGroup>
										</h:panelGroup>
									</h:panelGroup>
									<h:panelGroup layout="block" styleClass="EmptyBox1" />
									<h:panelGroup layout="block"
										styleClass="Container50 Responsive100">
										<h:panelGroup layout="block" styleClass="Container40">
											<h:panelGroup layout="block"
												styleClass="ContainerIndentLabel">
												<p:outputLabel for="lastproduct"
													value="#{messages.contact_lastproduct}:" />
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container60">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:selectOneMenu id="lastproduct"
													value="#{jJContactBean.contactUtil.lastProduct}"
													effect="fade" filter="#{!loginBean.mobile}"
													filterMatchMode="contains"
													converter="com.starit.janjoonweb.ui.mb.converter.JJProductConverter">

													<f:selectItem itemValue="#{null}"
														itemLabel="#{messages.contact_anyProduct}" />
													<f:selectItems value="#{jJProductBean.productList}" var="p"
														itemLabel="#{p.name}" itemValue="#{p}" />
													<p:ajax onstart="PF('blockUIWidget').block()"
														oncomplete="PF('blockUIWidget').unblock()"
														update="configForm" />
												</p:selectOneMenu>
											</h:panelGroup>
										</h:panelGroup>
									</h:panelGroup>

									<h:panelGroup layout="block"
										styleClass="Container50 Responsive100">
										<h:panelGroup layout="block" styleClass="Container40">
											<h:panelGroup layout="block"
												styleClass="ContainerIndentLabel">
												<p:outputLabel for="lastversion"
													value="#{messages.contact_lastversion}:" />
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container60">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:selectOneMenu id="lastversion"
													value="#{jJContactBean.contactUtil.lastVersion}"
													effect="fade" filter="#{!loginBean.mobile}"
													filterMatchMode="contains"
													converter="com.starit.janjoonweb.ui.mb.converter.JJVersionConverter">

													<f:selectItem itemValue="#{null}"
														itemLabel="#{messages.contact_anyVersion}" />
													<f:selectItems value="#{jJContactBean.versionList}" var="p"
														itemLabel="#{p.name}" itemValue="#{p}" />
												</p:selectOneMenu>
											</h:panelGroup>
										</h:panelGroup>
									</h:panelGroup>
									<h:panelGroup layout="block"
										rendered="#{loginBean.authorisationService.renderCategoryConfig}"
										styleClass="Container100">
										<h:panelGroup layout="block" styleClass="Container100">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:outputLabel for="categories"
													value="#{messages.contact_categories}:" />
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container100">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:selectManyMenu id="categories" scrollHeight="110"
													value="#{jJContactBean.loggedContactCategories}"
													converter="com.starit.janjoonweb.ui.mb.converter.JJCategoryConverter"
													showCheckbox="true">
													<f:selectItems value="#{jJContactBean.categories}"
														var="cat" itemLabel="#{cat.name}" itemValue="#{cat}" />
													<f:validator validatorId="listCategoriesValidator" />
												</p:selectManyMenu>
											</h:panelGroup>
										</h:panelGroup>
									</h:panelGroup>
									<h:panelGroup layout="block" styleClass="Container100">
										<h:panelGroup layout="block" styleClass="ContainerIndent">
											<p:commandButton id="submit" icon="fa fa-save Fs16"
												update=":vacationForm configForm :workdaysCalendar :growlForm "
												onstart="PF('blockUIWidget').block()"
												oncomplete="PF('blockUIWidget').unblock()"
												value="#{messages.contact_submit}"
												action="#{jJContactBean.updateUserConfiguration(loginBean,jJRequirementBean)}" />
										</h:panelGroup>
									</h:panelGroup>
								</h:panelGroup>

							</p:panel>
						</h:panelGroup>
					</h:panelGroup>

					<h:panelGroup layout="block" styleClass="Container40 Responsive100">
						<h:panelGroup layout="block" styleClass="ContainerIndent">
							<p:dataTable id="permissionDataTable" var="permission"
								scrollable="true" scrollHeight="200" styleClass="Container99"
								value="#{jJContactBean.contactUtil.permissions}"
								emptyMessage="#{messages.label_notRecordFound}">
								<f:facet name="header">
									<h:outputText
										value="#{messages.admin_contact_new_table_title} " />
								</f:facet>
								<p:column style="width:40%">
									<f:facet name="header">
										<p:row>
											<p:column>
												<h:outputText
													value="#{messages.admin_contact_new_table_profile_title}" />
											</p:column>
										</p:row>
									</f:facet>
									<h:outputText value="#{permission.profile.name}" />
								</p:column>

								<p:column style="width:30%">
									<f:facet name="header">
										<p:row>
											<p:column>
												<h:outputText
													value="#{messages.admin_contact_new_table_project_title}" />
											</p:column>
										</p:row>
									</f:facet>
									<h:outputText value="#{permission.project.name}" />
								</p:column>

								<p:column style="width:30%">
									<f:facet name="header">
										<p:row>
											<p:column>
												<h:outputText
													value="#{messages.admin_contact_new_table_product_title}" />
											</p:column>
										</p:row>
									</f:facet>
									<h:outputText value="#{permission.product.name}" />
								</p:column>
							</p:dataTable>
						</h:panelGroup>
					</h:panelGroup>
				</h:panelGroup>
			</h:form>
			<h:panelGroup layout="block" styleClass="EmptyBox20" />
			<h:panelGroup layout="block" styleClass="Container100">
				<h:panelGroup layout="block" styleClass="Container60 Responsive100">
					<h:form id="workdaysCalendar">
						<h:panelGroup layout="block" styleClass="ContainerIndent">
							<p:dataTable value="#{jJContactBean.workDays}" var="day"
								emptyMessage="#{messages.label_notRecordFound}"
								rendered="#{jJContactBean.workDays != null}">

								<p:columnGroup type="header">
									<p:row>
										<p:column colspan="5" style="text-align: left;"
											headerText="#{messages.contact_datatableHeader}" />
									</p:row>
									<p:row>
										<p:column rowspan="2" width="40%"
											headerText="#{messages.contact_dataTable_day}" />
										<p:column colspan="2" rowspan="1" width="30%"
											headerText="#{messages.contact_datatable_morning}" />
										<p:column colspan="2" rowspan="1" width="30%"
											headerText="#{messages.contact_datatable_afternoon}" />
									</p:row>
									<p:row>
										<p:column width="15%"
											headerText="#{messages.contact_dataTable_from}" />
										<p:column width="15%"
											headerText="#{messages.contact_dataTable_to}" />
										<p:column width="15%"
											headerText="#{messages.contact_dataTable_from}" />
										<p:column width="15%"
											headerText="#{messages.contact_dataTable_to}" />
									</p:row>
								</p:columnGroup>
								<p:column width="40%">
									<h:outputText value="#{day.day}" />
								</p:column>
								<p:column width="15%">
									<pe:timePicker value="#{day.startDate1}"
										locale="#{localeBean.locale}" showDeselectButton="true"
										mode="popup">
										<p:ajax event="timeSelect"
											update=":workdaysCalendar :vacationForm :configForm :growlForm"
											listener="#{jJContactBean.timeSelectListener(day,1,loginBean,loginBean.contact)}"
											onstart="PF('blockUIWidget').block();"
											oncomplete="PF('blockUIWidget').unblock();" />
									</pe:timePicker>
									<!-- 									<p:calendar value="#{day.startDate1}" pattern="HH:mm"  -->
									<!-- 										timeOnly="true" readonlyInput="true" showButtonPanel="true"> -->
									<!-- 										<p:ajax event="dateSelect" -->
									<!-- 											listener="#{jJContactBean.timeSelectListener(day,1,loginBean,loginBean.contact)}" -->
									<!-- 											update=":workdaysCalendar :vacationForm :configForm :growlForm" -->
									<!-- 											onstart="PF('blockUIWidget').block();" -->
									<!-- 											oncomplete="PF('blockUIWidget').unblock();" /> -->
									<!-- 									</p:calendar> -->
								</p:column>
								<p:column width="15%">
									<pe:timePicker value="#{day.endDate1}"
										showDeselectButton="true" mode="popup"
										locale="#{localeBean.locale}">
										<p:ajax event="timeSelect"
											update=":workdaysCalendar :vacationForm :configForm :growlForm"
											listener="#{jJContactBean.timeSelectListener(day,1,loginBean,loginBean.contact)}"
											onstart="PF('blockUIWidget').block();"
											oncomplete="PF('blockUIWidget').unblock();" />
									</pe:timePicker>
								</p:column>
								<p:column width="15%">
									<pe:timePicker value="#{day.startDate2}"
										locale="#{localeBean.locale}" showDeselectButton="true"
										mode="popup">
										<p:ajax event="timeSelect"
											update=":workdaysCalendar :vacationForm :configForm :growlForm"
											listener="#{jJContactBean.timeSelectListener(day,2,loginBean,loginBean.contact)}"
											onstart="PF('blockUIWidget').block();"
											oncomplete="PF('blockUIWidget').unblock();" />
									</pe:timePicker>
								</p:column>
								<p:column width="15%">
									<pe:timePicker value="#{day.endDate2}"
										showDeselectButton="true" mode="popup"
										locale="#{localeBean.locale}">
										<p:ajax event="timeSelect"
											update=":workdaysCalendar :vacationForm :configForm :growlForm"
											listener="#{jJContactBean.timeSelectListener(day,2,loginBean,loginBean.contact)}"
											onstart="PF('blockUIWidget').block();"
											oncomplete="PF('blockUIWidget').unblock();" />
									</pe:timePicker>
								</p:column>
							</p:dataTable>
						</h:panelGroup>
					</h:form>
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="Container40 Responsive100">
					<h:form id="vacationForm">
						<h:panelGroup layout="block" styleClass="Container100">
							<p:dataList var="vacation" paginator="true" rows="5"
								paginatorPosition="bottom" itemType="none"
								emptyMessage="#{messages.contact_empty_vacation}"
								value="#{jJContactBean.calendarUtil.vacation}" type="unordered">
								<f:facet name="header">#{messages.contact_vacances}</f:facet>
								<h:panelGroup layout="block" styleClass="Container">
									<h:panelGroup layout="block" styleClass="Container10">
										<h:panelGroup layout="block" styleClass="ContainerIndent">
											<p:commandButton icon="fa fa-trash Fs16"
												update="vacationForm :configForm :workdaysCalendar :growlForm"
												onstart="PF('blockUIWidget').block()"
												oncomplete="PF('blockUIWidget').unblock()"
												title="#{messages.label_delete}" immediate="true"
												actionListener="#{jJContactBean.removeVacation(loginBean,loginBean.contact,vacation.startVacation,vacation.endVacation)}"
												styleClass="littleButton" />
										</h:panelGroup>
									</h:panelGroup>
									<h:panelGroup layout="block" styleClass="Container45">
										<h:panelGroup layout="block" styleClass="Container20">
											<h:panelGroup layout="block"
												style="padding-left: 0px;padding-right: 0px;text-align: center;"
												styleClass="ContainerIndentLabel">
												<p:outputLabel value="#{messages.contact_from} :" />
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container80">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:inputText readonly="true"
													value="#{vacation.startVacation}">
													<f:convertDateTime type="date"
														locale="#{localeBean.locale}" pattern="dd/MM/yyyy HH:mm" />
												</p:inputText>
											</h:panelGroup>
										</h:panelGroup>
									</h:panelGroup>
									<h:panelGroup layout="block" styleClass="Container45">
										<h:panelGroup layout="block" styleClass="Container20">
											<h:panelGroup layout="block"
												style="padding-left: 0px;padding-right: 0px;text-align: center;"
												styleClass="ContainerIndentLabel">
												<p:outputLabel value=" #{messages.contact_to} :" />
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container80">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:inputText readonly="true" value="#{vacation.endVacation}">
													<f:convertDateTime type="date"
														locale="#{localeBean.locale}" pattern="dd/MM/yyyy HH:mm" />
												</p:inputText>
											</h:panelGroup>
										</h:panelGroup>
									</h:panelGroup>
								</h:panelGroup>
								<f:facet name="footer">
									<h:panelGroup layout="block" styleClass="Container">
										<h:panelGroup layout="block" styleClass="Container50">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:calendar id="start" navigator="true" effect="slideDown"
													required="true" pattern="dd/MM/yyyy HH:mm"
													binding="#{startDateCreation}" readonlyInput="true"
													placeholder="#{messages.contact_from}"
													value="#{jJContactBean.startDate}">
													<p:ajax event="dateSelect" update="addVacation :growlForm" />
												</p:calendar>
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container50">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:calendar id="end" navigator="true" effect="slideDown"
													required="true" pattern="dd/MM/yyyy HH:mm"
													value="#{jJContactBean.endDate}" readonlyInput="true"
													placeholder="#{messages.contact_to}">
													<f:validator validatorId="dateRangeValidator" />
													<f:attribute name="startDateComponent"
														value="#{startDateCreation}" />
													<p:ajax event="dateSelect" update="addVacation :growlForm" />
												</p:calendar>
											</h:panelGroup>
										</h:panelGroup>
										<h:panelGroup layout="block" styleClass="Container100">
											<h:panelGroup layout="block" styleClass="ContainerIndent">
												<p:commandButton id="addVacation"
													icon="fa fa-plus-square Fs20"
													onstart="PF('blockUIWidget').block()"
													oncomplete="PF('blockUIWidget').unblock()"
													disabled="#{jJContactBean.startDate == null || jJContactBean.endDate == null}"
													update="vacationForm :configForm :workdaysCalendar :growlForm"
													action="#{jJContactBean.addVacation(loginBean,loginBean.contact)}"
													value="#{messages.contact_new_vacation}" />
											</h:panelGroup>
										</h:panelGroup>
									</h:panelGroup>
								</f:facet>
							</p:dataList>
						</h:panelGroup>
					</h:form>
				</h:panelGroup>
			</h:panelGroup>
		</h:panelGroup>
		<p:dialog id="changePhotoDialog" draggable="false" modal="true"
			header="Photo" widgetVar="changePhotoDialogWidget" dynamic="true"
			resizable="false" responsive="true">
			<p:outputPanel id="changePhotoPanel">
				<h:form id="changePhotoForm">
					<p:fileUpload
						fileUploadListener="#{licenseBean.handleContactFileUpload}"
						mode="advanced" dragDropSupport="true"
						onstart="PF('blockUIWidget').block()"
						oncomplete="PF('blockUIWidget').unblock();PF('changePhotoDialogWidget').hide()"
						update=":vacationForm :configForm :workdaysCalendar :growlForm"
						sizeLimit="1000000" allowTypes="/(gif|png|ico|jpeg|jpg)$/" />
				</h:form>
			</p:outputPanel>
		</p:dialog>
	</ui:define>
</ui:composition>
</html>