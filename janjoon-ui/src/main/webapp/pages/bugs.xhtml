<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="../templates/layout.xhtml">
	<ui:define name="content">
		<p:panel id="bugPanel" header="BUG" style="width: 100%;valign: top;">
			<f:event listener="#{jJBugBean.initJJBug}" type="preRenderView" />

			<p:commandButton id="colorBtn" icon="ui-icon-info" type="button"
				style="float: right;" />
			<p:overlayPanel id="colorPanel" for="colorBtn" hideEffect="fade"
				dynamic="true" style="width:600px">
				<p:panelGrid>
					<f:facet name="header">
						<p:row>
							<p:column colspan="12">Code des Couleurs</p:column>
						</p:row>
					</f:facet>
					<p:row>
						<p:column colspan="2" styleClass="NEW">
							<p:outputLabel value="NEW" />
						</p:column>

						<p:column colspan="2" styleClass="CLOSED">
							<p:outputLabel value="CLOSED" />
						</p:column>

						<p:column colspan="2" styleClass="VERIFIED">
							<p:outputLabel value="VERIFIED" />
						</p:column>

						<p:column colspan="2" styleClass="RESOLVED">
							<p:outputLabel value="RESOLVED" />
						</p:column>

						<p:column colspan="2" styleClass="DUPLICATE">
							<p:outputLabel value="DUPLICATE" />
						</p:column>

						<p:column colspan="2" styleClass="WONTFIX">
							<p:outputLabel value="WONTFIX" />
						</p:column>
					</p:row>

					<p:row>


						<p:column colspan="2" styleClass="INVALID">
							<p:outputLabel value="INVALID" />
						</p:column>

						<p:column colspan="2" styleClass="FIXED">
							<p:outputLabel value="FIXED" />
						</p:column>

						<p:column colspan="2" styleClass="READY">
							<p:outputLabel value="READY" />
						</p:column>

						<p:column colspan="2" styleClass="REOPENED">
							<p:outputLabel value="REOPENED" />
						</p:column>

						<p:column colspan="2" styleClass="ASSIGNED">
							<p:outputLabel value="ASSIGNED" />
						</p:column>
					</p:row>
				</p:panelGrid>
			</p:overlayPanel>

			<h:form id="bugForm">
				<p:growl id="bugMessage" showDetail="true" />
				<p:dataTable id="bugTable2" sortMode="multiple"
					value="#{jJBugBean.bugList}" rowKey="#{bug.id}" var="bug"
					widgetVar="bugTable" scrollable="true" scrollHeight="400"
					filteredValue="#{jJBugBean.filteredJJBug}"
					rowStyleClass="#{bug.status.name}"
					emptyMessage="#{messages.bug_table_alert}"
					selection="#{jJBugBean.selectedBugList}">
					<p:ajax event="rowSelectCheckbox" update="bugTable2:deleteMButton" />
					<p:ajax event="rowUnselectCheckbox"
						update="bugTable2:deleteMButton" />
					<p:ajax event="toggleSelect" update="bugTable2:deleteMButton" />

					<f:facet name="header">
						<p:outputPanel>
							<h:outputText value="#{messages.bug_table_search_label}" />
							<p:inputText id="globalFilter" onkeyup="PF('bugTable').filter()"
								style="width:200px"
								placeholder="#{messages.bug_table_search_watermark}" />
						</p:outputPanel>
					</f:facet>

					<p:column selectionMode="multiple" style="width:2%" />

					<p:column headerText="#{messages.bug_table_title_title}"
						filterMatchMode="contains" sortBy="name" filterStyle="width: 90%;"
						style="width: 12% !important;height: 5px !important;">
						<h:outputText value="#{bug.name}" />
					</p:column>
					<p:column headerText="#{messages.bug_table_creation_title}"
						sortBy="creationDate"
						style="width: 10% !important;height: 5px !important;">
						<h:outputText value="#{bug.creationDate}">
							<f:converter converterId="extendedDateTimeConverter" />
							<f:attribute name="pattern" value="dd/MM/yyyy HH:mm" />
							<f:attribute name="timeZone" value="UCL" />
						</h:outputText>
					</p:column>
					<p:column headerText="#{messages.bug_table_criticity_title}"
						sortBy="criticity.name"
						style="width: 10% !important;height: 5px !important;"
						filterOptions="#{jJBugBean.criticityOptions}"
						filterMatchMode="exact" filterStyle="width: 90%;"
						filterBy="criticity.name">
						<h:outputText value="#{bug.criticity.name}" />
					</p:column>
					<p:column headerText="#{messages.bug_table_importance_title}"
						sortBy="importance.name"
						style="width: 10% !important;height: 5px !important;"
						filterOptions="#{jJBugBean.importanceOptions}"
						filterMatchMode="exact" filterStyle="width: 90%;"
						filterBy="importance.name">
						<h:outputText value="#{bug.importance.name}" />
					</p:column>
					<p:column headerText="#{messages.bug_table_status_title}"
						sortBy="status.name" filterBy="status.name"
						style="width: 10% !important;height: 5px !important;"
						filterOptions="#{jJBugBean.statusOptions}" filterMatchMode="exact"
						filterStyle="width: 90%;">
						<h:outputText value="#{bug.status.name}" />
					</p:column>
					<p:column styleClass="action-column">
						<f:facet name="header">
							<h:outputText value="#{messages.bug_table_action_title}" />
						</f:facet>
						<p:splitButton value="Action">
							<p:menuitem id="editButton" icon="ui-icon-pencil"
								value="#{messages.label_edit}" update=":editForm"
								oncomplete="editDialogWidget.show()"
								title="#{messages.label_edit}">
								<f:setPropertyActionListener value="#{bug}"
									target="#{jJBugBean.JJBug_}" />
								<f:setPropertyActionListener value="#{bug.project}"
									target="#{jJBugBean.bugProjectSelected}" />
								<f:setPropertyActionListener value="#{bug.requirement}"
									target="#{jJBugBean.bugRequirementSelected}" />
							</p:menuitem>
							<p:tooltip for="editButton" value="#{messages.label_edit}"
								showEffect="fade" hideEffect="fade" />
							<p:menuitem id="deleteButton" icon="ui-icon-trash"
								oncomplete="deleteDialogWidget.show()"
								value="#{messages.label_delete}"
								title="#{messages.label_delete}">
								<f:setPropertyActionListener value="#{bug}"
									target="#{jJBugBean.JJBug_}" />
							</p:menuitem>
							<p:tooltip for="deleteButton" value="#{messages.label_delete}"
								showEffect="fade" hideEffect="fade" />
						</p:splitButton>
					</p:column>
					<f:facet name="footer">
						<p:commandButton value="#{messages.bug_create_button}"
							id="createButton" icon="ui-icon-circle-plus"
							update=":createForm:createPanelGrid"
							oncomplete="createDialogWidget.show()"
							title="#{messages.label_create}" />
						<p:tooltip for="createButton" value="#{messages.label_create}"
							showEffect="fade" hideEffect="fade" />

						<p:commandButton value="#{messages.bug_delete_button}"
							id="deleteMButton" icon="ui-icon-trash" update=":createForm"
							oncomplete="deleteMDialogWidget.show()"
							disabled="#{empty jJBugBean.selectedBugList}"
							title="#{messages.label_delete}" />
						<p:tooltip for="deleteMButton" value="#{messages.label_delete}"
							showEffect="fade" hideEffect="fade" />
					</f:facet>
				</p:dataTable>
			</h:form>
			<p:dialog id="createDialog" header="#{messages.bug_create_title}"
				modal="true" widgetVar="createDialogWidget" dynamic="true"				
				visible="#{jJBugBean.createDialogVisible}" resizable="true"
				maximizable="true" showEffect="fade" hideEffect="explode">
				<p:ajax event="close" update="createForm"
					listener="#{jJBugBean.handleDialogClose}" />
				<p:outputPanel id="createPanel">
					<h:form id="createForm" enctype="multipart/form-data">
						<ui:include src="bugDialog.xhtml">
							<ui:param name="JJBug_" value="#{jJBugBean.JJBug_}" />
						</ui:include>
						<p:commandButton id="createSaveButton"
							onstart="PF('bugBlockUIWidget').block()"
							oncomplete="PF('bugBlockUIWidget').unblock()"
							value="#{messages.label_save}" action="#{jJBugBean.persistBug}"
							update="createPanelGrid,:bugForm:bugMessage,:bugForm" />
						<p:commandButton id="createCloseButton"
							value="#{messages.label_close}"
							onclick="createDialogWidget.hide()" type="button" />
					</h:form>
				</p:outputPanel>
			</p:dialog>

			<p:dialog id="editDialog" header="#{messages.bug_edit_title}"
				modal="true" widgetVar="editDialogWidget" dynamic="true"
				resizable="true" maximizable="true" showEffect="fade"
				hideEffect="explode">
				<p:ajax event="close" update=":bugForm"
					listener="#{jJBugBean.handleDialogClose}" />
				<p:outputPanel id="editPanel">
					<h:form id="editForm" enctype="multipart/form-data">
						<ui:include src="bugDialog.xhtml">
							<ui:param name="JJBug_" value="#{jJBugBean.JJBug_}" />
						</ui:include>
						<p:commandButton id="editSaveButton"
							onstart="PF('bugBlockUIWidget').block()"
							oncomplete="PF('bugBlockUIWidget').unblock()"
							value="#{messages.bug_edit_save_button}"
							action="#{jJBugBean.persistBug}"
							onsuccess="editDialogWidget.hide()"
							update="createPanelGrid :bugForm:bugMessage :bugForm" />
						<p:commandButton id="editCloseButton"
							value="#{messages.bug_edit_close_button}"
							onclick="editDialogWidget.hide()" type="button" />
					</h:form>
				</p:outputPanel>
			</p:dialog>

			<p:confirmDialog id="deleteDialog" widgetVar="deleteDialogWidget"
				message="#{messages.bug_delete_title}" showEffect="fade"
				hideEffect="explode" header="#{messages.bug_delete_confirm_label}"
				severity="alarm">
				<p:outputPanel id="deletePanel">
					<h:form id="deleteForm">
						<p:commandButton id="deleteYesButton"
							value="#{messages.bug_delete_yes_button}"
							action="#{jJBugBean.deleteSingle}"
							update=":bugForm :bugForm:bugMessage"
							onsuccess="deleteDialogWidget.hide()" />
						<p:commandButton id="deleteNoButton"
							value="#{messages.bug_delete_no_button}"
							onclick="deleteDialogWidget.hide()" type="button" />
					</h:form>
				</p:outputPanel>
			</p:confirmDialog>

			<p:confirmDialog id="deleteMDialog" widgetVar="deleteMDialogWidget"
				message="#{messages.bug_mdelete_title}" showEffect="fade"
				hideEffect="explode" header="#{messages.bug_mdelete_confirm_label}"
				severity="alarm">
				<p:outputPanel id="deleteMPanel">
					<h:form id="deleteMForm">
						<p:commandButton id="deleteYesButton"
							value="#{messages.bug_delete_yes_button}"
							action="#{jJBugBean.deleteMultiple}"
							update=":bugForm :bugForm:bugMessage"
							onsuccess="deleteMDialogWidget.hide()" />
						<p:commandButton id="deleteNoButton"
							value="#{messages.bug_delete_no_button}"
							onclick="deleteMDialogWidget.hide()" type="button" />
					</h:form>
				</p:outputPanel>
			</p:confirmDialog>
		</p:panel>
	</ui:define>
</ui:composition>
</html>