<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

<ui:composition template="../templates/template.xhtml">

	<ui:define name="content">
		<style type="text/css">
/* .mineSelect .ui-selectonemenu-trigger { */
/* 	display: none; */
/* } */

/* .ui-accordion .ui-accordion-header { */
/* 	background: #E6E6E6; */
/* } */
</style>

		<h:outputScript library="js" name="ckEditor.js" />
		<f:event type="preRenderComponent"
			oncomplete="PF('blockUIWidget').unblock()"
			listener="#{jJRequirementBean.initDataTabels}" />
		<h:form id="categoryForm" style="text-align: center;">
			<p:overlayPanel id="category-menu" for="show-category-menu"
				hideEffect="clip" widgetVar="category-menu"
				styleClass="ShowOnMobile">
				<c:forEach items="#{jJRequirementBean.categoryList}" var="category">
					<p:selectBooleanButton value="#{category.checked}"
						title="#{category.category.name}" style="width: 100%;"
						onLabel="#{category.category.name}"
						offLabel="#{category.category.name}"
						onIcon="fa fa-check Fs16 Yellow" offIcon="fa fa-close Fs16 White"
						id="Mcategory_#{category.category.id}">
						<p:ajax
							listener="#{jJRequirementBean.updateTemplate(category.category.id,null,true,category.checked)}"
							update="@form" onstart="PF('blockUIWidget').block()"
							oncomplete="PF('blockUIWidget').unblock();updateDataTable();" />
					</p:selectBooleanButton>
					<br />
					<br />
				</c:forEach>
			</p:overlayPanel>
			<h:panelGrid columns="3" styleClass="Responsive100 Container100">
				<p:commandButton value="&#9776;" id="show-category-menu"
					title="Category"
					style="font-weight:bold; float:none; position:relative;"
					styleClass="ShowOnMobile" />
				<h:panelGrid styleClass="ShowOnDesktop Responsive50"
					columns="#{fn:length(jJRequirementBean.categoryList)}">
					<c:forEach items="#{jJRequirementBean.categoryList}" var="category">
						<p:selectBooleanButton value="#{category.checked}"
							id="category_#{category.category.id}"
							onLabel="#{category.category.name}"
							offLabel="#{category.category.name}"
							onIcon="fa fa-check Fs16 Yellow" offIcon="fa fa-close Fs16 White"
							title="#{category.category.name}"
							style="#{jJRequirementBean.getMarginLeft(category)}">
							<p:ajax
								listener="#{jJRequirementBean.updateTemplate(category.category.id,null,true,category.checked)}"
								update="@form" onstart="PF('blockUIWidget').block()"
								oncomplete="PF('blockUIWidget').unblock();updateDataTable();" />
						</p:selectBooleanButton>
					</c:forEach>
				</h:panelGrid>
				<!-- 			<br /> -->
				<!-- 			<br /> -->
				<h:panelGrid columns="6" styleClass="Responsive50">
					<p:inputText id="globalFilter" style="width: 100px;"
						placeholder="#{messages.specification_table_requirement_filter}"
						value="#{jJRequirementBean.filterValue}" >
						<p:ajax event="keyup" listener="#{jJRequirementBean.filterTable}"
							onstart="PF('blockUIWidget').block()"
							oncomplete="PF('blockUIWidget').unblock();updateDataTable();" />
					</p:inputText>

					<p:selectOneMenu id="mineSpec" value="#{jJRequirementBean.mine}"
						title="#{messages.specification_table_requirement_filter}"
						styleClass="mineSelect" effect="fade">
						<f:selectItem itemValue="#{false}"
							itemLabel="#{messages.specification_table_requirement_all}" />
						<f:selectItem itemValue="#{true}"
							itemLabel="#{messages.specification_table_requirement_mine}" />
						<p:ajax onstart="PF('blockUIWidget').block()" event="change"
							oncomplete="PF('blockUIWidget').unblock()"
							listener="#{jJRequirementBean.mineChangeEvent}" />
					</p:selectOneMenu>

					<!-- 			<p:commandButton value="#{messages.specification_video_help_title}" -->
					<!-- 				title="#{messages.specification_video_help_title}" -->
					<!-- 				style="float: right;" id="videoHelpBtn" icon="ui-icon-video" -->
					<!-- 				onclick="PF('videoHelpWidget').show()" type="button" /> -->
					<!-- 			<p:commandButton id="headerButton" type="button" -->
					<!-- 				icon="fa fa-ellipsis-v Gray Fs16" styleClass="Fright GrayButton" -->
					<!-- 				style="float:left" /> -->
					<!-- 			<p:menu overlay="true" trigger="headerButton" my="left top" -->
					<!-- 				at="left bottom" style="width:14%;"> -->
					<!-- 				<p:menuitem icon="fa fa-arrow-down" -->
					<!-- 					disabled="#{jJRequirementBean.disabledExport}" -->
					<!-- 					actionListener="#{jJRequirementBean.loadImportFormat()}" -->
					<!-- 					update=":requirementImportDialog" resetValues="true" -->
					<!-- 					onstart="PF('blockUIWidget').block()" -->
					<!-- 					oncomplete="PF('blockUIWidget').unblock();PF('requirementImportDialogWidget').show()" -->
					<!-- 					value="#{messages.specification_import_button}" /> -->

					<!-- 				<p:menuitem icon="fa  fa-arrow-up" -->
					<!-- 					disabled="#{jJProjectBean.project == null}" update=":importXMLForm" -->
					<!-- 					onstart="PF('blockUIWidget').block()" -->
					<!-- 					rendered="#{loginBean.authorisationService.wRequiement}" -->
					<!-- 					oncomplete="PF('blockUIWidget').unblock();PF('requirementImportXMLDialogWidget').show()" -->
					<!-- 					value="#{messages.specification_importxml_button}" /> -->

					<!-- 				<p:menuitem id="reloadBtn" icon="fa fa-refresh" -->
					<!-- 					onstart="PF('blockUIWidget').block()" -->
					<!-- 					actionListener="#{jJRequirementBean.reloadPage}" -->
					<!-- 					value="#{messages.label_refresh}" update="globalFilter" /> -->
					<!-- 			</p:menu> -->

					<p:commandButton icon="fa fa-arrow-down Fs20"
						disabled="#{jJRequirementBean.disabledExport}"
						actionListener="#{jJRequirementBean.loadImportFormat()}"
						update=":requirementImportDialog" resetValues="true"
						onstart="PF('blockUIWidget').block()" style="float: right;"
						oncomplete="PF('blockUIWidget').unblock();PF('requirementImportDialogWidget').show()"
						title="#{messages.specification_import_button}" />

					<p:commandButton icon="fa  fa-arrow-up Fs20"
						disabled="#{jJProjectBean.project == null}"
						update=":importXMLForm" onstart="PF('blockUIWidget').block()"
						style="float: right;"
						rendered="#{loginBean.authorisationService.wRequiement}"
						oncomplete="PF('blockUIWidget').unblock();PF('requirementImportXMLDialogWidget').show()"
						title="#{messages.specification_importxml_button}" />

					<p:commandButton id="reloadBtn" icon="fa fa-refresh Fs20"
						onstart="PF('blockUIWidget').block()" style="float: right;"
						actionListener="#{jJRequirementBean.reloadPage}"
						title="#{messages.label_refresh}" update="globalFilter" />

					<p:commandButton id="colorBtn" icon="fa fa-info-circle Fs20"
						styleClass="Fright BlueButton" type="button" style="float: right;"
						title="#{messages.specification_video_help_title}" />
				</h:panelGrid>

			</h:panelGrid>
			<p:overlayPanel id="colorPanel" for="colorBtn" hideEffect="fade"
				style="width:600px">
				<p:panelGrid>
					<f:facet name="header">
						<p:row>
							<p:column colspan="12">#{messages.specification_color_title}</p:column>
						</p:row>
					</f:facet>
					<p:row>
						<p:column colspan="2" styleClass="UnLinked">
							<p:outputLabel style="color: #fff;"
								value="#{messages.specification_color_RequirementNotLinked_label}" />
						</p:column>
						<p:column colspan="2" styleClass="Specified">
							<p:outputLabel style="color: #fff;"
								value="#{messages.specification_color_RequirementNoTask_label}" />
						</p:column>
						<p:column colspan="2" styleClass="Progress">
							<p:outputLabel style="color: #fff;"
								value="#{messages.specification_color_RequirementInProcess_label}" />
						</p:column>
						<p:column colspan="2" styleClass="InTesting">
							<p:outputLabel style="color: #fff;"
								value="#{messages.specification_color_RequirementFinishedTestProcess_label}" />
						</p:column>
						<p:column colspan="2" styleClass="Finished">
							<p:outputLabel style="color: #fff;"
								value="#{messages.specification_color_RequirementFinishedSuccessed_label}" />
						</p:column>
					</p:row>
				</p:panelGrid>
			</p:overlayPanel>
		</h:form>
		<h:form id="specForm" style="overflow:hidden;width:100%">
			<p:remoteCommand name="updateDataTable" update="specForm"
				oncomplete="PF('blockUIWidget').unblock()" />
			<c:forEach items="#{jJRequirementBean.tableDataModelList}"
				var="tableDataModel" varStatus="loop">
				<p:panelGrid styleClass="Responsive"
					rendered="#{tableDataModel.rendered}"
					style="min-width:200px;margin-top: 10px;width: #{jJRequirementBean.getTableDataModelSizePct(tableDataModel)};#{jJRequirementBean.getDisplay(tableDataModel)}
							float: #{jJRequirementBean.tableDataModelFloatLeft};#{jJRequirementBean.getTableDataModelMargin(tableDataModel)}">
					<p:row>
						<p:column rendered="#{tableDataModel.expanded}"
							style="width: 34%;" styleClass="noPadding">
							<p:tree id="chapterTree" value="#{tableDataModel.chapterTree}"
								style="float: left;/*width: 100%;*/height: 540px;background: #F2F2F2;border: none;"
								var="node" selectionMode="single"
								rendered="#{tableDataModel.expanded}" dynamic="true">
								<p:ajax event="select"
									listener="#{jJRequirementBean.onNodeSelect}"
									onstart="PF('blockUIWidget').block()"
									oncomplete="PF('blockUIWidget').unblock()" />

								<p:treeNode type="withOutChapter">
									<h:outputText
										value="#{messages.specification_tree_withOutChapter}" />
								</p:treeNode>
								<p:treeNode type="chapter">
									<h:outputText value="CH-#{node.id}-#{node.name}" />
								</p:treeNode>
								<p:treeNode type="category">
									<h:outputText value="C-#{node.id}-#{node.name}" />
								</p:treeNode>
							</p:tree>
						</p:column>
						<p:column style="#{tableDataModel.tableStyle}"
							styleClass="noPadding">
							<p:dataTable id="categoryTable_#{loop.index}" var="reqUtil"
								value="#{tableDataModel}" scrollable="true" scrollHeight="400"
								sortMode="multiple" resizableColumns="true"
								styleClass="requirement-table"
								emptyMessage="#{messages.label_notRecordFound}"
								filteredValue="#{tableDataModel.filtredRequirements}"
								rowKey="#{reqUtil.requirement.id}" editable="true"
								editMode="cell" rendered="#{tableDataModel.rendered}"
								selectionMode="single"
								widgetVar="dataTable_#{loop.index}_Widget">
								<p:ajax event="rowDblselect"
									onstart="PF('blockUIWidget').block()"
									oncomplete="PF('blockUIWidget').unblock();PF('requirementDialogWidget').show()"
									update=":requirementDialog"
									disabled="#{!loginBean.authorisationService.wRequiement}"
									listener="#{jJRequirementBean.onRowDblClckSelect}" />

								<f:facet name="header">

									<!-- 									<p:commandButton id="optionsButton" type="button" -->
									<!-- 										icon="fa fa-ellipsis-v Gray Fs20" -->
									<!-- 										styleClass="Fright GrayButton" style="float:left" /> -->
									<!-- 									<p:menu overlay="true" trigger="optionsButton" my="left top" -->
									<!-- 										at="left bottom" style="width:11%;"> -->
									<!-- 										<p:menuitem icon="fa fa-arrows" -->
									<!-- 											onstart="PF('blockUIWidget').block()" -->
									<!-- 											oncomplete="PF('blockUIWidget').unblock();updateDataTable();" -->
									<!-- 											actionListener="#{jJRequirementBean.expandTable(tableDataModel)}" -->
									<!-- 											value="#{messages.specification_expand_button}" /> -->
									<!-- 										<p:menuitem id="manageChapterButton" -->
									<!-- 											icon="fa fa-folder" -->
									<!-- 											value="#{jJChapterBean.warnMessage}" -->
									<!-- 											update=":chapterDialogPanel" resetValues="true" -->
									<!-- 											disabled="#{jJChapterBean.disabledChapter or jJProjectBean.project == null}" -->
									<!-- 											actionListener="#{jJChapterBean.loadData(tableDataModel.categoryId)}" -->
									<!-- 											onstart="PF('blockUIWidget').block()" -->
									<!-- 											oncomplete="PF('blockUIWidget').unblock();PF('chapterDialogWidget').show()" /> -->
									<!-- 										<p:menuitem -->
									<!-- 											actionListener="#{jJChapterBean.updateCategoryId(tableDataModel,jJRequirementBean)}" -->
									<!-- 											value="#{messages.specification_req_exportTo}" -->
									<!-- 											resetValues="true" onclick="PF('exportMenuWidget').show();" -->
									<!-- 											update=":exportMenuPanel" -->
									<!-- 											icon="fa fa-ellipsis-v"> -->
									<!-- 											<f:setPropertyActionListener value="#{tableDataModel}" -->
									<!-- 												target="#{jJRequirementBean.categoryDataModel}" /> -->
									<!-- 										</p:menuitem> -->
									<!-- 										<p:menuitem id="newRequirementButton" -->
									<!-- 											icon="fa fa-plus-square" resetValues="true" -->
									<!-- 											value="#{loginBean.authorisationService.wRequiementMSG}" -->
									<!-- 											disabled="#{jJRequirementBean.disabledRequirement or !loginBean.authorisationService.wRequiement}" -->
									<!-- 											actionListener="#{jJRequirementBean.newRequirement(tableDataModel.categoryId)}" -->
									<!-- 											update=":requirementDialog" -->
									<!-- 											onstart="PF('blockUIWidget').block()" -->
									<!-- 											oncomplete="PF('blockUIWidget').unblock();PF('requirementDialogWidget').show()" /> -->
									<!-- 									</p:menu> -->

									<!-- 									<h:panelGrid style="text-align:center" columns="5" border="0" -->
									<!-- 										columnClasses="firstColumn,firstColumn,firstColumn,firstColumn,thirtyPercent"> -->
									<!-- 										<f:facet name="header"> -->
									<!-- 											<p:row> -->
									<!-- 												<p:column colspan="1"> -->

									<p:commandButton icon="fa fa-arrows F20"
										onstart="PF('blockUIWidget').block()" style="float: left;"
										oncomplete="PF('blockUIWidget').unblock();updateDataTable();"
										actionListener="#{jJRequirementBean.expandTable(tableDataModel)}"
										title="#{messages.specification_expand_button}" />
									<p:commandButton id="manageChapterButton"
										icon="fa fa-folder Fs20" title="#{jJChapterBean.warnMessage}"
										update=":chapterDialogPanel" resetValues="true"
										style="margin-left: 8%;float: left;"
										disabled="#{jJChapterBean.disabledChapter or jJProjectBean.project == null}"
										actionListener="#{jJChapterBean.loadData(tableDataModel.categoryId)}"
										onstart="PF('blockUIWidget').block()"
										oncomplete="PF('blockUIWidget').unblock();PF('chapterDialogWidget').show()" />
									<!-- 												</p:column> -->
									<!-- 												<p:column> -->
									<p:commandButton style="margin-left: 8%;float: left;"
										actionListener="#{jJChapterBean.updateCategoryId(tableDataModel,jJRequirementBean)}"
										title="#{messages.specification_req_exportTo}"
										resetValues="true" onclick="PF('exportMenuWidget').show();"
										update=":exportMenuPanel" icon="fa fa-ellipsis-v Fs20">
										<f:setPropertyActionListener value="#{tableDataModel}"
											target="#{jJRequirementBean.categoryDataModel}" />
									</p:commandButton>
									<!-- 												</p:column> -->
									<!-- 												<p:column colspan="1"> -->
									<p:commandButton id="newRequirementButton"
										style="margin-left: 8%;float: left;"
										icon="fa fa-plus-square Fs20" resetValues="true"
										title="#{loginBean.authorisationService.wRequiementMSG}"
										disabled="#{jJRequirementBean.disabledRequirement or !loginBean.authorisationService.wRequiement}"
										actionListener="#{jJRequirementBean.newRequirement(tableDataModel.categoryId)}"
										update=":requirementDialog"
										onstart="PF('blockUIWidget').block()"
										oncomplete="PF('blockUIWidget').unblock();PF('requirementDialogWidget').show()" />
									<!-- 												</p:column> -->
									<!-- 											</p:row> -->
									<!-- 										</f:facet> -->
									<!-- 									</p:panelGrid> -->
									<h:outputText value="#{tableDataModel.nameDataModel}" />
									<!-- 									</h:panelGrid> -->
								</f:facet>
								<p:column width="5%">
									<p:commandLink
										actionListener="#{jJRequirementBean.onrate(reqUtil.requirement)}"
										id="rate"
										update=":growlForm :messageCreationForm :headerForm:communicationButton categoryTable_#{loop.index}:rate"
										onstart="PF('blockUIWidget').block()"
										oncomplete="PF('blockUIWidget').unblock()">

										<p:graphicImage
											name="#{!jJRequirementBean.isRated(reqUtil.requirement) ? 'blackstar.ico' : 'yelstar.ico'}"
											width="16" height="16" cache="false" library="images"
											title="#{!jJRequirementBean.isRated(reqUtil.requirement) ? messages.requirement_subscription_rate_title : messages.requirement_subscription_cancel_rate_title}" />

									</p:commandLink>
								</p:column>

								<p:column rendered="false" exportable="false"
									filterBy="#{reqUtil.requirement.id}" filterStyle="display:none"
									sortBy="#{reqUtil.requirement.id}">
									<f:facet name="header">
										<h:outputText value="Id" />
									</f:facet>
									<h:outputText value="#{reqUtil.requirement.id}" />
								</p:column>
								<p:column filterBy="#{reqUtil.requirement.name}"
									filterStyle="display:none" styleClass="requirement-column"
									sortBy="#{reqUtil.requirement.name}">
									<f:facet name="header">
										<h:outputText
											value="#{messages.specification_table_requirement_title}" />
									</f:facet>
									<p:cellEditor>
										<f:facet name="output">
											<h:outputText
												value="#{messages['specification_'.concat(reqUtil.style)]}"
												styleClass="#{reqUtil.style}" />

											<h:outputText id="reqContent"
												style="white-space: normal;Line-Height: 2;"
												styleClass="Fs16"
												value="    ID:#{reqUtil.requirement.id} #{reqUtil.requirement.name}" />
											<p:tooltip id="toolTipContent" for="reqContent"
												showEffect="fade" hideEffect="fade" style="width:300px">
												<p:panelGrid style="width:300px">
													<f:facet name="header">
														<p:row>
															<p:column>
																<h:outputText style="font-weight: bold;"
																	value="Requirement: #{reqUtil.requirement.name}" />
															</p:column>
														</p:row>
													</f:facet>
													<p:row>
														<p:column>
															<p:outputLabel style="font-weight: bold;" for="tolDesc"
																value="Description :" />
															<br />
															<h:outputText id="tolDesc" readonly="true" escape="false"
																style="width:300px"
																value="#{reqUtil.requirement.description}" />
														</p:column>
													</p:row>
												</p:panelGrid>
											</p:tooltip>
										</f:facet>
										<f:facet name="input">

											<p:panelGrid
												style="border-style: groove;border-color: black;">
												<f:facet name="header">
													<p:row>
														<p:column>
															<h:outputText
																style="font-weight: bold;white-space: pre-wrap;"
																value="Requirement: #{reqUtil.requirement.name}" />
														</p:column>
													</p:row>
												</f:facet>
												<p:row>
													<p:column>
														<p:outputLabel style="font-weight: bold;" for="expDesc"
															value="Description :" />
														<br />
														<h:outputText id="expDesc" readonly="true" escape="false"
															value="#{reqUtil.requirement.description}"
															style="white-space: normal;" />
													</p:column>
												</p:row>
												<p:row>
													<p:column>
														<p:outputLabel style="font-weight: bold;" for="expStyle"
															value="Type:  " />
														<h:outputText id="expStyle"
															value="#{messages['specification_'.concat(reqUtil.style)]}"
															styleClass="#{reqUtil.style}" />
													</p:column>
												</p:row>
												<p:row rendered="#{reqUtil.requirement.note != null}">
													<p:column>
														<p:outputLabel style="font-weight: bold;" for="expNote"
															value="Note :" />
														<br />
														<h:outputText id="expNote" readonly="true" escape="false"
															style="white-space: normal;max-height: 127px;display: block;width: 100px;overflow: hidden;word-wrap: break-word;text-overflow: ellipsis"
															value="#{reqUtil.requirement.note}" />
													</p:column>
												</p:row>
											</p:panelGrid>

										</f:facet>
									</p:cellEditor>
								</p:column>
								<p:column exportable="false" styleClass="action-column"
									style="width: 50px !important;"
									rendered="#{!jJRequirementBean.expand or tableDataModel.expanded}">
									<f:facet name="header">
										<h:outputText value="Actions" />
									</f:facet>
									<p:commandButton id="viewButton" type="button"
										icon="fa fa-ellipsis-v Fs20" styleClass="BlueButton"
										style="min-width: 20px !important;min-height: 20px !important;height: 30px; width: 30px;" />
									<p:menu overlay="true" trigger="viewButton" my="left top"
										at="left bottom">
										<p:menuitem action="#{jJRequirementBean.requirementInfo}"
											title="#{messages.specification_table_actions_viewButton}"
											value="#{messages.label_view}" ajax="false"
											icon="fa fa-eye Fs16" onclick="target='_blank'">
											<f:setPropertyActionListener value="#{reqUtil.requirement}"
												target="#{jJRequirementBean.requirement}" />
										</p:menuitem>
										<p:menuitem id="filterButton"
											value="  #{messages[jJRequirementBean.filterButton]}"
											icon="fa fa-search Fs16"
											onstart="PF('blockUIWidget').block()"
											action="#{jJRequirementBean.viewLinks()}"
											oncomplete="PF('blockUIWidget').unblock();updateDataTable();">
											<f:setPropertyActionListener value="#{reqUtil.requirement}"
												target="#{jJRequirementBean.viewLinkRequirement}" />
										</p:menuitem>

										<p:menuitem id="editButton" icon="fa fa-pencil Fs16"
											action="#{jJRequirementBean.editRequirement()}"
											onstart="PF('blockUIWidget').block()"
											oncomplete="PF('blockUIWidget').unblock();PF('requirementDialogWidget').show()"
											update=":requirementDialog"
											value="#{messages.specification_table_actions_editButton}"
											disabled="#{jJRequirementBean.getDisabledEdit(reqUtil.requirement) or !loginBean.authorisationService.wRequiement}">
											<f:setPropertyActionListener value="#{reqUtil.requirement}"
												target="#{jJRequirementBean.requirement}" />
										</p:menuitem>

										<p:menuitem id="mindMapButton"
											value="#{messages.specification_table_actions_mapButton}"
											title="#{messages.specification_table_actions_mindMapButton}"
											icon="fa fa-search Fs16"
											onstart="PF('blockUIWidget').block()"
											action="#{jJRequirementBean.initReqMindMap}"
											oncomplete="PF('blockUIWidget').unblock()"
											update=":mindMapForm">
											<f:setPropertyActionListener value="#{reqUtil.requirement}"
												target="#{jJRequirementBean.requirement}" />
										</p:menuitem>

										<p:menuitem id="deleteButton" icon="fa fa-trash Fs16"
											title="#{messages.specification_table_actions_deleteButton}"
											oncomplete="PF('requirementDeleteDialogWidget').show()"
											value="#{messages.specification_table_actions_deleteButton}">
											<f:setPropertyActionListener value="#{reqUtil.requirement}"
												target="#{jJRequirementBean.requirement}" />
										</p:menuitem>

									</p:menu>
									<!-- 									<p:splitButton id="viewButton" -->
									<!-- 										action="#{jJRequirementBean.requirementInfo}" -->
									<!-- 										title="#{messages.specification_table_actions_viewButton}" -->
									<!-- 										value="#{messages.label_view}" ajax="false" icon="ui-icon-eye" -->
									<!-- 										onclick="target='_blank'"> -->
									<!-- 										<p:menuitem id="filterButton" -->
									<!-- 											value="#{messages[jJRequirementBean.filterButton]}" -->
									<!-- 											icon="ui-icon-search" onstart="PF('blockUIWidget').block()" -->
									<!-- 											action="#{jJRequirementBean.viewLinks()}" -->
									<!-- 											oncomplete="PF('blockUIWidget').unblock();updateDataTable();"> -->
									<!-- 											<f:setPropertyActionListener value="#{reqUtil.requirement}" -->
									<!-- 												target="#{jJRequirementBean.viewLinkRequirement}" /> -->
									<!-- 										</p:menuitem> -->

									<!-- 										<p:menuitem id="editButton" icon="ui-icon-pencil" -->
									<!-- 											action="#{jJRequirementBean.editRequirement()}" -->
									<!-- 											onstart="PF('blockUIWidget').block()" -->
									<!-- 											oncomplete="PF('blockUIWidget').unblock();PF('requirementDialogWidget').show()" -->
									<!-- 											update=":requirementDialog" -->
									<!-- 											value="#{messages.specification_table_actions_editButton}" -->
									<!-- 											disabled="#{jJRequirementBean.getDisabledEdit(reqUtil.requirement) or !loginBean.authorisationService.wRequiement}"> -->
									<!-- 											<f:setPropertyActionListener value="#{reqUtil.requirement}" -->
									<!-- 												target="#{jJRequirementBean.requirement}" /> -->
									<!-- 										</p:menuitem> -->

									<!-- 										<p:menuitem id="mindMapButton" -->
									<!-- 											value="#{messages.specification_table_actions_mapButton}" -->
									<!-- 											title="#{messages.specification_table_actions_mindMapButton}" -->
									<!-- 											icon="ui-icon-search" onstart="PF('blockUIWidget').block()" -->
									<!-- 											action="#{jJRequirementBean.initReqMindMap}" -->
									<!-- 											oncomplete="PF('blockUIWidget').unblock()" -->
									<!-- 											update=":mindMapForm"> -->
									<!-- 											<f:setPropertyActionListener value="#{reqUtil.requirement}" -->
									<!-- 												target="#{jJRequirementBean.requirement}" /> -->
									<!-- 										</p:menuitem> -->

									<!-- 										<p:menuitem id="deleteButton" icon="ui-icon-trash" -->
									<!-- 											title="#{messages.specification_table_actions_deleteButton}" -->
									<!-- 											oncomplete="PF('requirementDeleteDialogWidget').show()" -->
									<!-- 											value="#{messages.specification_table_actions_deleteButton}"> -->
									<!-- 											<f:setPropertyActionListener value="#{reqUtil.requirement}" -->
									<!-- 												target="#{jJRequirementBean.requirement}" /> -->
									<!-- 										</p:menuitem> -->
									<!-- 										<f:setPropertyActionListener value="#{reqUtil.requirement}" -->
									<!-- 											target="#{jJRequirementBean.requirement}" /> -->
									<!-- 									</p:splitButton> -->
								</p:column>
								<f:facet name="footer">
									<p:accordionPanel dynamic="true" styleClass="mineAccordion"
										activeIndex="#{tableDataModel.activeIndex}" cache="false">
										<p:ajax event="tabClose"
											listener="#{jJRequirementBean.onTabClose(tableDataModel.categoryId)}" />
										<p:ajax event="tabChange"
											listener="#{jJRequirementBean.calculateCovCom(tableDataModel.categoryId)}"
											onstart="PF('blockUIWidget').block()"
											oncomplete="PF('blockUIWidget').unblock()" />
										<p:tab title="#{messages.specification_progress_footer}">
											<p:row>
												<p:progressBar id="coverage"
													value="#{tableDataModel.coverageProgress}"
													labelTemplate="#{messages.specification_coverage_progress} {value}%"
													displayOnly="true" />
												<br />
											</p:row>
											<p:row>
												<br />
												<p:progressBar id="completion"
													value="#{tableDataModel.completionProgress}"
													labelTemplate="#{messages.specification_completion_progress} {value}%"
													displayOnly="true" />
											</p:row>
										</p:tab>
									</p:accordionPanel>
								</f:facet>
							</p:dataTable>
						</p:column>
					</p:row>
				</p:panelGrid>
			</c:forEach>
		</h:form>

		<p:hotkey bind="esc" handler="PF('requirementDialogWidget').hide()" />
		<p:hotkey bind="alt+enter"
			handler="PF('requirementSaveWidget').jq.click()" />
		<p:dialog id="requirementDialog" draggable="false" 
			header="#{messages[jJRequirementBean.message]}" modal="true" responsive="true"
			widgetVar="requirementDialogWidget" dynamic="true" resizable="false" position="center" 
			style="padding:0px;min-height:320px;height:80%;max-height:700px;min-width:300px;width:80% !important;max-width:1200px !important;">
			<p:ajax event="close"
				listener="#{jJRequirementBean.closeDialog(false,true)}"
				onstart="PF('blockUIWidget').block()"
				oncomplete="PF('blockUIWidget').unblock()" />
			<p:outputPanel id="requirementDialogPanel">
				<ui:include src="requirementDialog.xhtml" />
			</p:outputPanel>
		</p:dialog>

		<p:hotkey bind="esc" handler="PF('chapterDialogWidget').hide()" />
		<p:dialog id="chapterDialog" draggable="false" appendTo="@(body)"
			header="#{messages.specification_chapter_header}" modal="true"
			widgetVar="chapterDialogWidget" dynamic="true" resizable="false">
			<p:ajax event="close" onstart="PF('blockUIWidget').block()"
				oncomplete="PF('blockUIWidget').unblock();updateDataTable();"
				listener="#{jJChapterBean.closeDialog}" />
			<p:outputPanel id="chapterDialogPanel">
				<ui:include src="chapterDialog.xhtml" />
			</p:outputPanel>
		</p:dialog>

		<p:confirmDialog id="requirementDeleteDialog"
			header="#{messages.specification_delete_title}"
			message="#{messages.specification_delete_label}"
			widgetVar="requirementDeleteDialogWidget" showEffect="fade"
			hideEffect="fade" severity="alarm">
			<p:outputPanel id="requirementDeletePanel">
				<h:form id="requirementDeleteForm">
					<p:commandButton id="deleteYesButton"
						value="#{messages.specification_delete_yes_button}"
						action="#{jJRequirementBean.deleteRequirement}"
						update=":growlForm"
						onstart="PF('requirementDeleteDialogWidget').hide();PF('blockUIWidget').block()"
						oncomplete="PF('blockUIWidget').unblock();updateDataTable();" />
					<p:commandButton id="deleteNoButton"
						value="#{messages.specification_delete_no_button}"
						onclick="PF('requirementDeleteDialogWidget').hide()" type="button" />
				</h:form>
			</p:outputPanel>
		</p:confirmDialog>

		<p:confirmDialog id="requirementReleaseDialog"
			header="#{messages.specification_release_title}"
			message="#{messages.specification_release_label}"
			widgetVar="requirementReleaseDialogWidget" showEffect="fade"
			hideEffect="fade" severity="alarm">
			<p:outputPanel id="requirementReleasePanel">
				<h:form id="requirementReleaseForm">
					<p:commandButton id="releaseYesButton"
						value="#{messages.specification_release_yes_button}"
						action="#{jJRequirementBean.releaseRequirement}"
						update=":growlForm"
						onstart="PF('requirementReleaseDialogWidget').hide();PF('blockUIWidget').block()"
						oncomplete="PF('blockUIWidget').unblock();updateDataTable();" />
					<p:commandButton id="releaseNoButton"
						value="#{messages.specification_release_no_button}"
						onclick="PF('requirementReleaseDialogWidget').hide()"
						type="button" />
				</h:form>
			</p:outputPanel>
		</p:confirmDialog>

		<p:hotkey bind="esc" handler="PF('videoHelpWidget').hide()" />
		<p:dialog id="videoHelpDialog" widgetVar="videoHelpWidget"
			position="center" header="#{messages.specification_video_help_title}"
			style="padding:0px;" resizable="false" draggable="false"
			minHeight="500" minWidth="500" showEffect="fade" hideEffect="fade">
			<video width="100%" height="100%" controls="true">
				<source src="https://www.starit.fr/jjtraining.mp4" type="video/mp4" />
			</video>
		</p:dialog>

		<p:hotkey bind="esc"
			handler="PF('requirementImportDialogWidget').hide()" />
		<p:dialog id="requirementImportXMLDialog" draggable="false"
			modal="true" header="#{messages.specification_import_title} XML"
			widgetVar="requirementImportXMLDialogWidget" dynamic="true"
			resizable="false">
			<p:outputPanel id="importXMLPanel">
				<h:form id="importXMLForm">
					<p:fileUpload
						fileUploadListener="#{jJRequirementBean.handleImportXML}"
						mode="advanced" dragDropSupport="false"
						oncomplete="updateDataTable();" update=":growlForm :categoryForm"
						sizeLimit="100000" fileLimit="1" allowTypes="/(\.|\/)(xml)$/" />
				</h:form>
			</p:outputPanel>
		</p:dialog>
		<p:dialog id="exportMenu" draggable="false" modal="true"
			widgetVar="exportMenuWidget" dynamic="true" resizable="false"
			header="#{messages.specification_export_title}">
			<p:outputPanel id="exportMenuPanel">
				<h:form id="exportMenuForm">
					<h:panelGrid columns="2" width="100%">
						<p:commandLink ajax="false"
							oncomplete="PF('exportMenuWidget').show();"
							onclick="PrimeFaces.monitorDownload(start, stop);">
							<p:graphicImage name="xmlButton.ico" width="64" height="64"
								library="images"
								title="#{messages.specification_req_exportTo} XML" />
							<p:fileDownload
								value="#{jJRequirementBean.categoryDataModel.file}" />
						</p:commandLink>
						<p:commandLink onclick="PrimeFaces.monitorDownload(start, stop);"
							ajax="false" oncomplete="PF('exportMenuWidget').show();">
							<p:graphicImage name="pdf.png" width="64" height="64"
								library="images" title="#{jJRequirementBean.warnMessage}" />
							<p:fileDownload value="#{jJChapterBean.preProcessPDF}" />
						</p:commandLink>

						<p:commandLink onclick="PrimeFaces.monitorDownload(start, stop);"
							ajax="false" oncomplete="PF('exportMenuWidget').show();">
							<p:graphicImage name="xmlButton.ico" width="64" height="64"
								library="images"
								title="#{messages.specification_req_exportTo} XML" />
							<p:fileDownload
								value="#{jJRequirementBean.categoryDataModel.file}" />
						</p:commandLink>
						<p:commandLink onclick="PrimeFaces.monitorDownload(start, stop);"
							ajax="false" oncomplete="PF('exportMenuWidget').show();">
							<p:graphicImage name="pdf.png" width="64" height="64"
								library="images" title="#{jJRequirementBean.warnMessage}" />
							<p:fileDownload value="#{jJChapterBean.preProcessPDF}" />
						</p:commandLink>
					</h:panelGrid>
				</h:form>
			</p:outputPanel>
		</p:dialog>
		<p:dialog id="requirementImportDialog" draggable="false"
			header="#{messages.specification_import_title}" modal="true"
			widgetVar="requirementImportDialogWidget" dynamic="true"
			resizable="false">
			<p:ajax event="close" onstart="PF('blockUIWidget').block()"
				oncomplete="PF('blockUIWidget').unblock();updateDataTable();"
				listener="#{jJRequirementBean.closeDialogImport}" />

			<p:outputPanel id="importPanel">
				<pe:blockUI widgetVar="importBlockUIWidget" target="importPanel">
					<h:panelGrid columns="2">
						<p:graphicImage name="images/preloader.gif" library="rioLayout"
							style="vertical-align: middle;" />
						<h:outputText value="#{messages.label_refresh}"
							style="white-space: nowrap;" />
					</h:panelGrid>
				</pe:blockUI>

				<h:form id="importForm">
					<p:panelGrid>
						<p:row>
							<p:column>
								<p:outputLabel for="projectSelectOneMenu"
									value="#{messages.specification_import_project_label}" />
							</p:column>
							<p:column>
								<p:selectOneMenu id="projectSelectOneMenu"
									value="#{jJRequirementBean.importProject}"
									panelStyle="width:150px" effect="fade" style="width:160px"
									filter="true" filterMatchMode="startsWith"
									converter="com.starit.janjoonweb.ui.mb.converter.JJProjectConverter">

									<f:selectItem itemValue="#{null}"
										itemLabel="#{messages.specification_import_select_label}" />
									<f:selectItems value="#{jJRequirementBean.importProjectList}"
										var="p" itemLabel="#{p.name}" itemValue="#{p}" />
									<p:ajax partialSubmit="true"
										onstart="PF('importBlockUIWidget').block()"
										oncomplete="PF('importBlockUIWidget').unblock()"
										listener="#{jJRequirementBean.handelSelectImportProject}"
										update="importDataTable :importForm:importButton" />
								</p:selectOneMenu>
							</p:column>
							<p:column>
								<p:outputLabel for="categorySelectOneMenu"
									value="#{messages.specification_import_category_label}" />
							</p:column>
							<p:column>
								<p:selectOneMenu id="categorySelectOneMenu"
									value="#{jJRequirementBean.importCategory}"
									panelStyle="width:150px" effect="fade" style="width:160px"
									filter="true" filterMatchMode="startsWith"
									converter="com.starit.janjoonweb.ui.mb.converter.JJCategoryConverter">

									<f:selectItem itemValue="#{null}"
										itemLabel="#{messages.specification_import_select_label}" />
									<f:selectItems value="#{jJRequirementBean.importCategoryList}"
										var="p" itemLabel="#{p.name}" itemValue="#{p}" />
									<p:ajax partialSubmit="true"
										onstart="PF('importBlockUIWidget').block()"
										oncomplete="PF('importBlockUIWidget').unblock()"
										listener="#{jJRequirementBean.handelSelectImportCategory}"
										update="importDataTable :importForm:importButton" />
								</p:selectOneMenu>
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<p:outputLabel for="productSelectOneMenu"
									value="#{messages.specification_import_product_label}" />
							</p:column>
							<p:column>
								<p:selectOneMenu id="productSelectOneMenu"
									value="#{jJRequirementBean.importProduct}"
									panelStyle="width:150px" effect="fade" style="width:160px"
									filter="true" filterMatchMode="startsWith"
									converter="com.starit.janjoonweb.ui.mb.converter.JJProductConverter">

									<f:selectItem itemValue="#{null}"
										itemLabel="#{messages.specification_import_select_label}" />
									<f:selectItems value="#{jJRequirementBean.importProductList}"
										var="p" itemLabel="#{p.name}" itemValue="#{p}" />
									<p:ajax partialSubmit="true"
										onstart="PF('importBlockUIWidget').block()"
										oncomplete="PF('importBlockUIWidget').unblock()"
										listener="#{jJRequirementBean.handelSelectImportProduct}"
										update="importDataTable versionSelectOneMenu :importForm:importButton" />
								</p:selectOneMenu>
							</p:column>
							<p:column>
								<p:outputLabel for="versionSelectOneMenu"
									value="#{messages.specification_import_version_label}" />
							</p:column>
							<p:column>
								<p:selectOneMenu id="versionSelectOneMenu"
									value="#{jJRequirementBean.importVersion}"
									panelStyle="width:150px" effect="fade" style="width:160px"
									filter="true" filterMatchMode="startsWith"
									disabled="#{jJRequirementBean.disableImportVersion}"
									converter="com.starit.janjoonweb.ui.mb.converter.JJVersionConverter">

									<f:selectItem itemValue="#{null}"
										itemLabel="#{messages.specification_import_select_label}" />
									<f:selectItems value="#{jJRequirementBean.importVersionList}"
										var="v" itemLabel="#{v.name}" itemValue="#{v}" />
									<p:ajax partialSubmit="true"
										onstart="PF('importBlockUIWidget').block()"
										oncomplete="PF('importBlockUIWidget').unblock()"
										listener="#{jJRequirementBean.handelSelectImportVersion}"
										update="importDataTable :importForm:importButton" />
								</p:selectOneMenu>
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<p:outputLabel for="statusSelectOneMenu"
									value="#{messages.specification_import_status_label}" />
							</p:column>
							<p:column>
								<p:selectOneMenu id="statusSelectOneMenu"
									value="#{jJRequirementBean.importStatus}"
									panelStyle="width:150px" effect="fade" style="width:160px"
									filter="true" filterMatchMode="startsWith"
									converter="com.starit.janjoonweb.ui.mb.converter.JJStatusConverter">

									<f:selectItem itemValue="#{null}"
										itemLabel="#{messages.specification_import_select_label}" />
									<f:selectItems value="#{jJRequirementBean.importStatusList}"
										var="p"
										itemLabel="#{messages['status_'.concat(fn:replace(p.name, ' ', '_'))]}"
										itemValue="#{p}" />
									<p:ajax partialSubmit="true"
										onstart="PF('importBlockUIWidget').block()"
										oncomplete="PF('importBlockUIWidget').unblock()"
										listener="#{jJRequirementBean.handelSelectImportStatus}"
										update="importDataTable :importForm:importButton" />
								</p:selectOneMenu>
							</p:column>
						</p:row>
					</p:panelGrid>

					<p:dataTable id="importDataTable" var="format" scrollable="true"
						style="width:550px;" scrollHeight="300"
						emptyMessage="#{messages.label_notRecordFound}"
						value="#{jJRequirementBean.importFormats}">
						<f:facet name="header">
							<h:outputText
								value="#{messages.specification_import_table_title}" />
						</f:facet>
						<p:column style="width:10%;text-align: center;">
							<f:facet name="header">
								<p:selectBooleanCheckbox
									value="#{jJRequirementBean.copyRequirements}">
									<p:ajax update="importDataTable :importForm:importButton"
										onstart="PF('importBlockUIWidget').block()"
										oncomplete="PF('importBlockUIWidget').unblock()"
										listener="#{jJRequirementBean.copyRequirementsListener}" />
								</p:selectBooleanCheckbox>
							</f:facet>
							<p:selectBooleanCheckbox value="#{format.copyRequirement}">
								<p:ajax update="importDataTable :importForm:importButton"
									listener="#{jJRequirementBean.copyRequirementListener}" />
							</p:selectBooleanCheckbox>
						</p:column>
						<p:column style="width:50%">
							<f:facet name="header">
								<h:outputText
									value="#{messages.specification_import_requirement_header}" />
							</f:facet>
							<h:outputText value="#{format.requirement.name}" />
						</p:column>

						<p:column style="width:20%;text-align: center;">
							<f:facet name="header">
								<p:row>
									<p:column>
										<h:outputText
											value="#{messages.specification_import_testcase_header}" />
									</p:column>
								</p:row>
							</f:facet>
							<p:selectBooleanCheckbox value="#{format.copyTestcase}">
								<p:ajax update="importDataTable"
									listener="#{jJRequirementBean.copyTestcase}" />
							</p:selectBooleanCheckbox>
						</p:column>

						<p:column style="width:20%;text-align: center;">
							<f:facet name="header">
								<p:row>
									<p:column>
										<h:outputText
											value="#{messages.specification_import_chapter_header}" />
									</p:column>
								</p:row>
							</f:facet>
							<p:selectBooleanCheckbox value="#{format.copyChapter}">
								<p:ajax update="importDataTable"
									listener="#{jJRequirementBean.copyChapter}" />
							</p:selectBooleanCheckbox>
						</p:column>
					</p:dataTable>

					<h3 style="margin-top: 0" />
					<p:commandButton id="importButton" value="Import"
						update=":growlForm" onstart="PF('importBlockUIWidget').block()"
						oncomplete="PF('importBlockUIWidget').unblock();updateDataTable();"
						style="float: right;"
						disabled="#{jJRequirementBean.disableImportButton}"
						action="#{jJRequirementBean.importRequirement()}" />
				</h:form>
			</p:outputPanel>
		</p:dialog>

		<p:dialog id="requirementMindMap"
			header="#{messages.specification_MindMap_title}" modal="true"
			draggable="false" widgetVar="requirementMindMap" dynamic="true"
			resizable="true">
			<p:panel>
				<ui:include src="mindMapReq.xhtml" />
			</p:panel>
		</p:dialog>
	</ui:define>
</ui:composition>
</html>
