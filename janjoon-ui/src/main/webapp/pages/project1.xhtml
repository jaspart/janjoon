<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

<ui:composition template="../templates/layout.xhtml">
	<ui:define name="content">
		<p:tabView id="projecttabview" widgetVar="tabView" dynamic="true"
			cache="true" activeIndex="#{loginBean.activeTabProjectIndex}">
			<p:ajax event="tabChange" listener="#{loginBean.onTabProjectChange}"
				update="projecttabview :deleteForm" />
			<p:tab id="tabPlanning" title="#{messages.project_gantt_menuitem}">
				<h:panelGrid columns="1" cellpadding="3" style="width:100%">
					<ui:insert name="planning">
						<ui:include src="planning.xhtml" />
					</ui:insert>
				</h:panelGrid>
			</p:tab>

			<p:tab title="#{messages.project_scrum_menuitem}">
				<h:panelGrid columns="1" cellpadding="3">
					<ui:insert name="scrum">
						<ui:include src="scrum.xhtml" />
					</ui:insert>
				</h:panelGrid>
			</p:tab>
		</p:tabView>
		<p:confirmDialog id="deleteDialog" widgetVar="deleteDialogWidget"
			message="#{messages.task_delete_title}" showEffect="fade"
			hideEffect="explode" header="#{messages.task_delete_confirm_label}"
			severity="alarm">
			<p:outputPanel id="deletePanel">
				<h:form id="deleteForm">
					<p:commandButton id="deleteYesSprint"
						rendered="#{loginBean.activeTabProjectIndex == 1}"
						value="#{messages.bug_delete_yes_button}"
						action="#{jJSprintBean.deleteTask}"
						update=":projecttabview:SprintTabView"/>
					<p:commandButton id="deleteYesPlanning"
						rendered="#{loginBean.activeTabProjectIndex == 0}"
						value="#{messages.bug_delete_yes_button}"
						action="#{jJTaskBean.deleteTaskData}"
						update=":projecttabview:planningForm"
						oncomplete="deleteDialogWidget.hide()" />
					<p:commandButton id="deleteNoButton"
						value="#{messages.bug_delete_no_button}"
						oncomplete="PF('createSprintBlockUI').unblock()"
						onclick="deleteDialogWidget.hide()" type="button" />
				</h:form>
			</p:outputPanel>
		</p:confirmDialog>
		<p:dialog id="taskImportDialog" header="Import Tasks" modal="true"
			draggable="#{jJTaskBean.mode != 'scrum'}"
			widgetVar="taskImportDialogWidget" dynamic="true" resizable="false">
			<p:ajax event="close" update=":projecttabview:planningForm"
				listener="#{jJTaskBean.closeDialogImport}" />
			<p:outputPanel id="importTaskDialogPanel">
				<ui:insert name="importTask">
					<ui:include src="importTask.xhtml" />
				</ui:insert>
			</p:outputPanel>
		</p:dialog>

		<p:dialog id="viewTaskDialog" header="#{messages.label_view} JJTask"
		modal="true" widgetVar="viewTaskDialogWidget" dynamic="true"
		resizable="true" maximizable="true" showEffect="fade"
		hideEffect="explode" draggable="false">
		<p:outputPanel id="viewTaskPanel">
			<h:form id="viewTaskForm" enctype="multipart/form-data">
				<ui:include src="taskDialog.xhtml">
					<ui:param name="JJTask_" value="#{jJTaskBean.task}" />
				</ui:include>
				<p:commandButton id="viewCloseButton"
					value="#{messages.label_close}"
					oncomplete="PF('createSprintBlockUI').unblock()"
					onclick="viewTaskDialogWidget.hide()" type="button" />
			</h:form>
		</p:outputPanel>
	</p:dialog>		

		<pe:blockUI target="projecttabview" widgetVar="createSprintBlockUI">
			<h:panelGrid columns="2">
				<h:graphicImage library="images" name="ajax-loader.gif"
					style="margin-right: 12px; vertical-align: middle;" />
				<h:outputText value="Executing User operation..."
					style="white-space: nowrap;" />
			</h:panelGrid>
		</pe:blockUI>
	</ui:define>
</ui:composition>
</html>