<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:form id="ContactForm">
	<p:panel id="ContactPanel" style="width:600px" columns="1"
		cellpadding="6">

		<p:commandButton value="New" id="newContact"
			actionListener="#{jJContactBean.newContact}"
			update=":tabview:contactDialog"
			oncomplete="contactDialogWidget.show()" icon="ui-icon-circle-plus" />

		<p:contextMenu for="ContactDataTable">
			<p:menuitem value="Delete" update="ContactDataTable" icon="ui-icon-close"
				actionListener="#{jJContactBean.deleteContact}" />
		</p:contextMenu>

		<p:dataTable id="ContactDataTable"
			var="contact"
			rowKey="contact.firstname"
			value="#{jJContactBean.contactList}"
			selection="#{jJContactBean.selectedContact}"
			selectionMode="single"
			scrollHeight="450"
			resizableColumns="true"
			scrollable="true"
			style="width:550px">
		
		<p:ajax event="rowSelect" listener="#{jJContactBean.onRowSelect}" />
		
		<f:facet name="header">  
            Contact List  
        </f:facet>

			<p:column>
				<f:facet name="header">
					<h:outputText value="Firstname" />
				</f:facet>
				<h:outputText value="#{contact.firstname}" />
			</p:column>

			<p:column>
				<f:facet name="header">
					<h:outputText value="Lastname" />
				</f:facet>
				<h:outputText value="#{contact.lastname}" />
			</p:column>

			<p:column>
				<f:facet name="header">
					<h:outputText value="Email" />
				</f:facet>
				<h:outputText value="#{contact.email}" />
			</p:column>
		</p:dataTable>

	</p:panel>

</h:form>

<p:dialog id="contactDialog" header="#{jJContactBean.message}"
	modal="true" widgetVar="contactDialogWidget" dynamic="true"
	showEffect="fade" hideEffect="explode">
	<p:ajax event="close" update=":tabview:ContactForm"
		listener="#{jJContactBean.dialogClose}" />
	<p:outputPanel id="contactDialogPanel">
		<h:form id="contactDialogForm">
			<p:growl id="msg" />
			<p:panelGrid columns="1" cellpadding="6">
				<p:panelGrid columns="2" cellpadding="6">
					<p:panel columns="3" cellpadding="6">
						<p:inputText id="firstname"
							value="#{jJContactBean.contact.firstname}" label="Firstname"
							required="true" widgetVar="firstnameWidget">
							<f:validateLength maximum="25" />
						</p:inputText>
						<p:message for="firstname" id="msgFirstname" />
						<p:watermark for="firstname" value="Firstname *" />


						<p:inputText id="lastname"
							value="#{jJContactBean.contact.lastname}" label="Lastname"
							required="true" widgetVar="lastnameWidget">
							<f:validateLength maximum="25" />
						</p:inputText>
						<p:message for="lastname" id="msgLastname" />
						<p:watermark for="lastname" value="Lastname *" />


						<p:inputText id="email" value="#{jJContactBean.contact.email}"
							label="Email" required="true" widgetVar="emailWidget" />
						<p:message for="email" id="msgEmail" />
						<p:watermark for="email" value="Email *" />
						<h:outputText value="#{jJContactBean.contact.email}" />
					</p:panel>

					<p:panel columns="1" cellpadding="6">
						<p:panel columns="2" cellpadding="6">
							<h:outputText value="Password: *" />
							<p:password id="password"
								value="#{jJContactBean.contact.password}" feedback="true"
								inline="true" label="Password" required="true"
								widgetVar="passwordWidget" />
							<p:message for="password" id="msgPassword" />
						</p:panel>
						<p:selectBooleanButton value="#{jJContactBean.contact.enabled}"
							onLabel="Active" offLabel="Inactive" onIcon="ui-icon-check"
							offIcon="ui-icon-close">
							<p:ajax update="msg" listener="#{jJContactBean.addMessage}" />
						</p:selectBooleanButton>
					</p:panel>
				</p:panelGrid>
				<p:panel columns="7" cellpadding="6">

					<h:outputLabel value="Profile: *" />
					<p:selectOneMenu id="selectOneMenuProfile"
						value="#{jJContactBean.selectedProfile}" panelStyle="width:150px"
						effect="fade" style="width:160px" filter="true"
						filterMatchMode="startsWith" required="true"
						widgetVar="profileWidget" label="Profile">

						<f:converter
							converterId="com.funder.janjoonweb.ui.mb.converter.JJProfileConverter" />

						<f:selectItem itemLabel="#{jJContactBean.selectedProfile.name}"
							itemValue="#{jJContactBean.selectedProfile}" />
						<f:selectItems value="#{jJContactBean.profileList}" var="p"
							itemLabel="#{p.name}" itemValue="#{p}" />

					</p:selectOneMenu>

					<h:outputLabel value="Project:" />
					<p:selectOneMenu id="selectOneMenuProject"
						value="#{jJContactBean.selectedProject}" panelStyle="width:150px"
						effect="fade" style="width:160px" filter="true"
						filterMatchMode="startsWith" widgetVar="projectWidget">

						<f:converter
							converterId="com.funder.janjoonweb.ui.mb.converter.JJProjectConverter" />

						<f:selectItem itemLabel="#{jJContactBean.selectedProject.name}"
							itemValue="#{jJContactBean.selectedProject}" />
						<f:selectItems value="#{jJContactBean.projectList}" var="p"
							itemLabel="#{p.name}" itemValue="#{p}" />

					</p:selectOneMenu>

					<h:outputLabel value="Product:" />
					<p:selectOneMenu id="selectOneMenuProduct"
						value="#{jJContactBean.selectedProduct}" panelStyle="width:150px"
						effect="fade" style="width:160px" filter="true"
						filterMatchMode="startsWith" widgetVar="productWidget">

						<f:converter
							converterId="com.funder.janjoonweb.ui.mb.converter.JJProductConverter" />

						<f:selectItem itemLabel="#{jJContactBean.selectedProduct.name}"
							itemValue="#{jJContactBean.selectedProduct}" />
						<f:selectItems value="#{jJContactBean.productList}" var="p"
							itemLabel="#{p.name}" itemValue="#{p}" />

					</p:selectOneMenu>

					<p:commandButton id="addPermission"
						update="msg permissionDataTable"
						actionListener="#{jJContactBean.addPermission}"
						icon="ui-icon-circle-plus"
						process="@widgetVar(profileWidget) @widgetVar(projectWidget) @widgetVar(productWidget)" />


				</p:panel>

				<p:dataTable id="permissionDataTable" var="permission"
					value="#{jJContactBean.permissionList}" scrollRows="10"
					scrollable="true" liveScroll="true" scrollHeight="150"
					style="width:700px">
					<f:facet name="header">  
            			Permission List  
        			</f:facet>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Profile" />
						</f:facet>
						<h:outputText value="#{permission.profile.name}" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Project" />
						</f:facet>
						<h:outputText value="#{permission.project.name}" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Product" />
						</f:facet>
						<h:outputText value="#{permission.product.name}" />
					</p:column>
				</p:dataTable>


			</p:panelGrid>
			<p:commandButton id="submitButton" value="Save"
				update="contactDialogForm"
				process="@widgetVar(firstnameWidget) @widgetVar(lastnameWidget) @widgetVar(emailWidget) @widgetVar(passwordWidget)"
				action="#{jJContactBean.save}" />
		</h:form>
	</p:outputPanel>
</p:dialog>


</html>